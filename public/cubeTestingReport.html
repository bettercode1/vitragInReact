<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Vitrag Associates LLP - Final Test Report</title>

    <style>
        :root {
            --paper-width: 210mm;
            --paper-height: 297mm;
            --page-margin: 15mm;
            --title-color: #b30000;
            --subtitle-color: #063a6c;
            --highlight-color: #ffff00;
            --border-color: #000000;
            --text-color: #000000;
        }

        @page {
            size: A4;
            margin: 15mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 12px;
            color: var(--text-color);
            line-height: 1.2;
            background: #ffffff;
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
        }

        .page {
            width: var(--paper-width);
            min-height: var(--paper-height);
            background: #fff;
            padding: var(--page-margin);
            box-sizing: border-box;
            position: relative;
            margin: 0 auto;
            border: 1px solid #ddd;
        }

        /* Header Section - 3 Column Flexbox */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            width: 100%;
            margin-top: -30px;
        }

        .header-left {
            flex: 0 0 auto;
        }

        .header-center {
            flex: 1;
            text-align: center;
            padding: 0 20px;
        }

        .header-right {
            flex: 0 0 auto;
            text-align: center;
        }

        .logo-left {
            height: 90px;
            width: 160px;
            border: 2px solid #666666;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ffffff;
            margin-top: -32px;
        }

        .logo-left img {
            height: 85px;
            width: 110px;
            object-fit: contain;
        }

        .company-name {
            font-family: 'Times New Roman';
            font-size: 28px;
            font-weight: bold;
            color: #B22222;
            margin-bottom: 8px;
            line-height: 1.1;
            text-align: left;
        }

        .company-subtitle {
            font-family: 'Times New Roman';
            font-size: 18px;
            /* font-style: italic; */
            color: #0000CC;
            margin-bottom: 10px;
            line-height: 1.1;
            text-align: left;
            margin-left: 20px;
        }

        .header-divider {
            width: 100%;
            height: 2px;
            background-color: #000000;
            margin-bottom: 15px;
        }

        /* Extended divider for pages 2 and 3 */
        .header-divider-extended {
            width: 100%;
            height: 2px;
            background-color: #000000;
            margin-bottom: 15px;
            margin-top: 10px;
        }

        /* ANNEXURE Page Styling */
        .annexure-content {
            margin: 20px 0;
            font-family: 'Times New Roman', Times, serif;
        }

        .annexure-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #000000;
            margin: 20px 0 0 0;
        }

        .annexure-table th,
        .annexure-table td {
            border: 0.5px solid #000000;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
        }

        .annexure-table th {
            font-weight: bold;
            font-size: 11px;
            background-color: transparent;
        }

        .annexure-table td {
            width: 33.33%;
            height: 200px;
        }

        .annexure-image {
            width: 100%;
            height: 180px;
            object-fit: contain;
            background-color: #f5f5f5;
        }

        .annexure-caption {
            text-align: center;
            font-weight: bold;
            font-size: 10px;
            border: 1px solid #000000;
            padding: 5px;
           
        }

        .formula-box {
            width: 60%;
            margin: 20px 0;
            border: 1px solid #000000;
            padding: 15px;
            text-align: left;
            font-family: 'Times New Roman', Times, serif;
            display: flex;
            align-items: center;
            min-height: 50px;
        }

        .formula-text {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .formula-fraction {
            display: inline-block;
            vertical-align: middle;
            margin: 0 5px;
            font-size: 16px;
        }

        .formula-numerator {
            display: block;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
        }

        .formula-line {
            border-top: 1px solid #000000;
            margin: 2px 0;
            width: 100%;
        }

        .formula-denominator {
            display: block;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
        }

        .formula-explanation {
            margin-top: 15px;
            font-size: 12px;
            font-style: italic;
        }

        /* Mathematical Fraction Styling */
        .math-fraction {
            display: inline-block;
            vertical-align: middle;
            margin: 0 8px;
            text-align: center;
        }

        .math-numerator {
            display: block;
            font-size: 14px;
            font-weight: bold;
            line-height: 1;
            padding-bottom: 2px;
        }

        .math-denominator {
            display: block;
            font-size: 14px;
            font-weight: bold;
            line-height: 1;
            padding-top: 2px;
            border-top: 1px solid #000000;
        }

        .test-witnessed {
            margin-top: 34px;
            text-align: left;
            font-weight: bold;
            text-decoration: underline;
            color: #004080;
            font-size: 16px;
            text-transform: uppercase;
        }

        /* Observations Page Styling */
        .observations-content {
            margin: 20px 0;
            font-family: 'Times New Roman', Times, serif;
        }

        .observations-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #000000;
            margin: 20px 0;
        }

        .observations-table th,
        .observations-table td {
            border: 0.5px solid #000000;
            padding: 4px;
            text-align: left;
            vertical-align: top;
        }

        .observations-table th {
            font-weight: bold;
            font-size: 16px;
            background-color: transparent;
            width: 50%;
        }

        .observations-table td {
            font-size: 15px;
            width: 50%;
        }

        .chart-container {
            margin: 30px 0 80px 0;
            text-align: center;
        }



        .bar-chart {
            width: 85%;
            justify-self: center;
            height: 300px;
            border: 1px solid #000000;
            margin: 20px auto;
            position: relative;
            background-color: #ffffff;
        }

        .chart-caption {
            text-align: center;
            font-weight: bold;
            font-size: 10px;
            margin-top: 10px;
        }

        .chart-legend {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 10px;
        }

        .legend-item {
            display: inline-block;
            margin-right: 15px;
        }

        .legend-color {
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 5px;
            vertical-align: middle;
        }

        .legend-blue {
            background-color: #0066cc;
        }

        .legend-orange {
            background-color: #ff6600;
        }

.report-title-header {
    font-family: 'Times New Roman', Times, serif;
    font-size: 18px;
    font-weight: bold;
    color: #000000;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
    margin-top: -10px;
    margin-bottom: -15px;
    margin-right: 70px;
    text-align: center;
    margin-left: 0;
}

/* First page header - different styling */
.report-title-header-page1 {
    font-family: 'Times New Roman', Times, serif;
    font-size: 18px;
    font-weight: bold;
    color: #000000;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
    margin-top: -10px;
    margin-bottom: -15px;
    text-align: center;
    margin-left: 0;
}


        .logo-right {
            height: 90px;
            width: auto;
            /* margin-bottom: 8px; */
            margin-top: 13px;
        }

        .logo-right img {
            height: 90px;
            width: auto;
            margin-top: -20px;
            object-fit: contain;
        }

        .certificate-number {
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
            font-weight: bold;
            color: #000000;
            margin-top: -10px;
        }

        /* Report Title */
        .report-title {
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            color: var(--text-color);
            text-transform: uppercase;
            /* border-top: 2px solid var(--border-color); */
            /* border-bottom: 2px solid var(--border-color); */
            /* padding: 8px 0; */
            /* margin: 15px 0; */
        }

        /* Details Table */
        .details-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            margin-top: -15px;
            font-size: 14px;
            font-family: 'Times New Roman';
        }

        .details-table td {
            border: 1px solid var(--border-color);
            padding: 2px 6px;
            vertical-align: middle;
            font-family: 'Times New Roman', Times, serif;
            height: 20px;
        }

        #age-of-specimen {
            height: 20px;
            padding: 2px 6px;
        }

        .details-table td:first-child {
            font-weight: normal;
            width: 25%;
            font-family: 'Times New Roman', Times, serif;
        }

        .details-table td:nth-child(2) {
            width: 25%;
            font-family: 'Times New Roman', Times, serif;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            line-height: 1.2;
        }

        .details-table td:nth-child(3) {
            font-weight: normal;
            width: 25%;
            font-family: 'Times New Roman', Times, serif;
        }

        .details-table td:nth-child(4) {
            width: 25%;
            font-family: 'Times New Roman', Times, serif;
        }

        .highlight {
            background-color: transparent;
        }

        .highlight-text {
            background-color: var(--highlight-color);
            padding: 2px 4px;
            border-radius: 2px;
            display: inline-block;
        }

        .age-cell-content {
            display: flex;
            align-items: center;

            width: 100%;
        }

        .age-divider {
            width: 1px;
            height: 24px;
            margin-top: -10px;
            margin-bottom: -10px;
            margin-left: 55px;
            margin-right: 6px;
            background-color: #000000;

        }

        .age-cell-content span:last-child {
            text-align: left;
            flex: 1;
        }

        /* Grade Header in Table */
        .grade-header {
            background-color: transparent;
            padding: 8px 12px;
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
            font-weight: bold;
            color: #000000;
            text-align: left;
            border: 1px solid var(--border-color);
            width: 31%;
            vertical-align: top;
        }

        .grade-text {
            background-color: var(--highlight-color);
            padding: 4px 8px;
            border-radius: 3px;
            display: inline-block;
        }

        /* Sample Description Table */
    .sample-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 8px;
      font-size: 12px;
      font-family: 'Times New Roman', Times, serif;
    }

        .sample-table th,
        .sample-table td {
            border: 1px solid var(--border-color);
            padding: 2px 6px;
            text-align: center;
            vertical-align: middle;
            font-family: 'Times New Roman', Times, serif;
            height: 20px;
        }

       

    .sample-table th {
      background-color: transparent;
      font-weight: bold;
      padding: 2px 6px;
      line-height: 1.2;
      height: 20px;
    }

    /* Individual column widths for Sample Table */
    .sample-table th:nth-child(1),
    
    .sample-table td:nth-child(1) {
      width: 8%;
    }

    .sample-table th:nth-child(2),
    .sample-table td:nth-child(2) {
      width: 26%;
    }

    .sample-table th:nth-child(3),
    .sample-table td:nth-child(3) {
      width: 11%;
    }

    .sample-table th:nth-child(4),
    .sample-table td:nth-child(4) {
      width: 11%;
    }

    .sample-table th:nth-child(5),
    .sample-table td:nth-child(5) {
      width: 11%;
    }

    .sample-table th:nth-child(6),
    .sample-table td:nth-child(6) {
      width: 11%;
    }

    .sample-table th:nth-child(7),
    .sample-table td:nth-child(7) {
      width: 11%;
    }

    .sample-table th:nth-child(8),
    .sample-table td:nth-child(8) {
      width: 11%;
    }

        .sample-table .table-title {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            background-color: transparent;
            border: 1px solid var(--border-color);
            padding: 8px 12px;
        }

        /* Test Result Table */
        .test-result-title {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            background-color: transparent;
            padding: 4px 6px;
            margin: 2px auto 0 auto;
            width: 80%;
            font-family: 'Times New Roman', Times, serif;
            text-decoration: underline;
        }

        .test-result-table {
            width: 75%;
            border-collapse: collapse;
            margin: 0 auto 8px auto;
            font-size: 12px;
            font-family: 'Times New Roman', Times, serif;
        }

        .test-result-table th,
        .test-result-table td {
            border: 1px solid var(--border-color);
            padding: 2px 6px;
            text-align: center;
            vertical-align: middle;
            font-family: 'Times New Roman', Times, serif;
            height: 20px;
        }

        .test-result-table th {
            background-color: transparent;
            font-weight: bold;
        }

        .test-result-table .table-title {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            background-color: transparent;
        }

        .test-result-table .highlight-cell {
            background-color: transparent;
            font-weight: bold;
        }

        .test-result-table .highlight-cell .highlight-text {
            background-color: var(--highlight-color);
            padding: 2px 4px;
            border-radius: 2px;
            font-size: 16px;
            display: inline-block;
        }

        /* Individual column widths for Test Result Table */
        .test-result-table th:nth-child(1),
        .test-result-table td:nth-child(1) {
            width: 10%;
        }

        .test-result-table th:nth-child(2),
        .test-result-table td:nth-child(2) {
            width: 15%;
        }

        .test-result-table th:nth-child(3),
        .test-result-table td:nth-child(3) {
            width: 20%;
        }

        .test-result-table th:nth-child(4),
        .test-result-table td:nth-child(4) {
            width: 25%;
        }

        .test-result-table th:nth-child(5),
        .test-result-table td:nth-child(5) {
            width: 30%;
        }

        /* Terms & Conditions */
        .terms-section {
            margin: 20px 0;
            font-size: 12px;
        }

        .terms-section h4 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .terms-section ol {
            margin-left: 15px;
        }

        .terms-section li {
            margin-bottom: 3px;
        }

        /* Signature Section */
        .signature-section {
            margin: 20px 0;
            margin-top: 40px;
            position: relative;
            height: 120px;
        }

        /* Reviewed by section - Left side */
        .reviewed-section {
            position: absolute;
            left: 0;
            top: 0;
            width: 250px;
            text-align: left;
        }

        .reviewed-section .title {
            font-weight: bold;
            margin-bottom: 5px;
            margin-left: 65px;
            color: #004080;
            font-size: 12px;
        }

        .reviewed-section .name {
            font-weight: bold;
            color: #004080;
            font-size: 12px;
            margin-left: 125px;
        }

        .reviewed-section .subtitle {
            font-style: italic;
            margin-top: 5px;
            font-size: 12px;
            margin-left: 125px;
            color: #004080;
        }

        .reviewed-section .details {
            margin-top: 5px;
            font-size: 12px;
            margin-left: 125px;
            color: #004080;
        }

        /* Stamp section - Center */
        .stamp-section {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .stamp-section .stamp {
            width: 120px;
            height: auto;
        }

        /* Authorized by section - Right side */
        .authorized-section {
            position: absolute;
            margin-left: -10px;
            right: 0;
            top: 0;
            width: 250px;
            text-align: right;
        }

        .authorized-section .title {
            font-weight: bold;
            margin-bottom: 5px;
            margin-right: 165px;
            color: #004080;
            font-size: 12px;
        }

        .authorized-section .name {
            font-weight: bold;
            color: #004080;
            margin-right: 65px;
            font-size: 12px;
        }

        .authorized-section .subtitle {
            font-style: italic;
            margin-top: 5px;
            font-size: 11px;
            margin-right: 78px;

            color: #004080;
        }

        .authorized-section .details {
            margin-top: 5px;
            font-size: 10px;
            margin-right: 78px;
            color: #004080;
        }

        /* Specific styling for different designations in authorized section */
        .authorized-section .qualification-1 {
            margin-top: 5px;
            font-size: 12px;
            margin-right: 78px;
            color: #004080;
        }

        .authorized-section .qualification-2 {
            margin-top: 5px;
            font-size: 11px;
            /* margin-right: 2px; */
            color: #004080;
        }

        /* Page Header for additional pages */
        .page-header {
            margin-bottom: 20px;
            text-align: center;
        }

        .page-content {
            margin: 20px 0;
            font-size: 12px;
            line-height: 1.4;
        }

        .page-content h3 {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--subtitle-color);
        }

        /* Footer Section */
        .footer {
            position: absolute;
            bottom: 15mm;
            left: 15mm;
            right: 15mm;
            font-size: 12px;
            width: calc(100% - 30mm);
        }

        .footer-divider {
            text-align: center;
            font-weight: bold;
            margin-bottom: 8px;
            white-space: nowrap;
            font-size: 16px;
            color: #000000;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12px;
            margin-top: 10px;
        }

        .footer-left {
            text-align: left;
            flex: 1;
        }

        .footer-center {
            text-align: center;
            flex: 2;
            color: red;
            font-size: 11px;
        }

        .footer-right {
            text-align: right;
            flex: 1;
        }

        /* Print Optimization */
        @media print {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }

            .page {
                box-shadow: none;
                border: none;
                margin: 0;
                padding: 15mm;
                width: 210mm;
                min-height: 297mm;
                max-height: 297mm;
                overflow: hidden;
            }

            .page * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
        }

        /* Header Table for Page 1 */
        .header-table{ width:100%; border-collapse:collapse; table-layout:fixed; }
        .header-table td{ border:1px solid #111; vertical-align:middle; padding:12px 16px; }
        .logo-cell{ width:3.9cm; text-align:center; }
        .logo-cell img{ width:3.26cm; height:auto; object-fit:contain; }
        .title-cell{ text-align:center; font-weight:700; }
        .title-cell h1{ margin:0; font-size:33px; font-weight:700; color:var(--title-color); text-transform:uppercase; line-height:1.0; }
        .title-cell .subtitle{ display:block; margin-top:8px; font-size:19px; font-weight:700; color:var(--subtitle-color); line-height:1.0; white-space:nowrap; }

        /* Metadata table */
        .meta-wrap{ margin-top:10px; }
        table.meta{ width:100%; border-collapse:collapse; table-layout:fixed; }
        table.meta td{ border:1px solid #111; padding:4px 6px; height:0cm; vertical-align:middle; font-size:14.67px; overflow:hidden; white-space:normal; word-wrap:break-word; width:25% !important; }
        table.meta tr{ height:0cm; }
        
        /* Auto-sizing classes for different text lengths */
        table.meta td.auto-fit{ font-size:clamp(8px, 2.5vw, 14.67px); }
        table.meta td.auto-resize{ font-size:14.67px; white-space:normal; overflow:hidden; text-overflow:unset; }
        table.meta td.auto-resize.long-text{ font-size:12px; }
        table.meta td.auto-resize.very-long-text{ font-size:10px; }
        table.meta td.auto-resize.extra-long-text{ font-size:8px; }
        
        /* Remarks section styling */
        #remarks-content {
            font-size: 16px;
            line-height: 1.4;
            min-height: 30mm;
            max-height: 30mm;
            height: 30mm;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* Remarks section auto-sizing */
        #remarks-content.auto-resize{ font-size:16px; white-space:normal; overflow:hidden; text-overflow:unset; }
        #remarks-content.auto-resize.long-text{ font-size:14px; }
        #remarks-content.auto-resize.very-long-text{ font-size:12px; }
        #remarks-content.auto-resize.extra-long-text{ font-size:10px; }
        
        /* Make all columns same width - this rule should be last */
        table.meta td{ width:25% !important; }

        /* Test result */
        .test-result{ margin-top:12px; padding:0; }
        .test-result h3{ margin:0; text-align:center; font-size:16px; font-weight:700; text-transform:uppercase; text-decoration:underline; text-underline-offset: 4px; border:none; }

        table.results{ width:100%; border-collapse:collapse; margin-top:4px; font-size:16px; table-layout:auto; }
        table.results th, table.results td{ border:1px solid #111; text-align:center; vertical-align:middle; }
        table.results thead th{ background:#f7f2f2; font-weight:700; font-size:16px; padding:2px; height:0.6cm; }
        table.results tbody tr{ height:0.8cm; }
        table.results th:first-child, table.results td:first-child{ width:1%; }
        table.results th:nth-child(2), table.results td:nth-child(2){ width:12%; }
        table.results th:nth-child(3), table.results td:nth-child(3){ width:55%; }
        table.results th:nth-child(4), table.results td:nth-child(4){ width:8%; }
        table.results th:nth-child(5), table.results td:nth-child(5){ width:12%; }
        table.results th:nth-child(6), table.results td:nth-child(6){ width:22%; }
        /* Base styles for table.results tfoot - only for Average row */
        table.results tfoot tr:first-child td{ border:1px solid #111; height:1cm; font-weight:700; text-align:right; padding-right:6px; }
        table.results tfoot tr:first-child td:last-child{ text-align:center; }
        /* Remarks row */
        table.results tfoot tr:nth-child(2) td{ border:1px solid #111; height:25mm; vertical-align:top; text-align:left; padding:6px; font-weight:normal; }
        
        /* Old signature table CSS removed - now using dedicated signature table CSS below */

        /* ========================================
           SIGNATURE TABLE - Page 1 (Dedicated CSS - SEPARATE TABLE)
           ======================================== */
        
        /* Signature table base styles */
        .signature-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            table-layout: fixed;
        }
        
        /* Signature table rows - Base styles with LEFT alignment */
        .signature-table td {
            height: 0.7cm;
            border: 1px solid #111;
            text-align: left !important;
            padding-left: 8px !important;
            font-weight: 700 !important;
            font-size: 16px !important;
        }
        
        /* Column widths for signature table */
        .signature-table td:first-child {
            width: 35% !important;
        }
        
        .signature-table td:nth-child(2) {
            width: 30% !important;
        }
        
        .signature-table td:last-child {
            width: 35% !important;
        }
        
        /* Signature title cells */
        .signature-cell-title {
            font-weight: 700 !important;
            font-size: 16px !important;
            text-align: left !important;
            padding-left: 8px !important;
        }
        
        /* Signature name spans */
        .signature-name {
            font-weight: 700;
        }
        
        /* Signature date cells */
        .signature-cell-date {
            font-weight: 700 !important;
            font-size: 16px !important;
            text-align: left !important;
            padding-left: 8px !important;
        }
        
        /* Signature sign cells */
        .signature-cell-sign {
            font-weight: 700 !important;
            font-size: 16px !important;
            text-align: left !important;
            padding-left: 8px !important;
        }

        /* Download Button */
        .download-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .download-btn:hover {
            background: #218838;
        }

        @media print {
            .download-btn {
                display: none !important;
            }
        }
    </style>
</head>

<body>
    <script>
        // IMMEDIATE EXECUTION - Update data BEFORE anything else
        (function() {
            console.log('üö® IMMEDIATE SCRIPT RUNNING!');
            const urlParams = new URLSearchParams(window.location.search);
            
            // Update customer name IMMEDIATELY
            const customerName = urlParams.get('customer_name') || '';
            const siteName = urlParams.get('site_name') || '';
            const siteAddress = urlParams.get('site_address') || '';
            
            console.log('IMMEDIATE UPDATE - Customer:', customerName, 'Site:', siteName);
            
            // Wait for DOM then update ALL fields
            document.addEventListener('DOMContentLoaded', function() {
                console.log('üî• DOM READY - FORCE UPDATING ALL FIELDS NOW!');
                
                // Update customer
                const el = document.getElementById('customer-site-name');
                if (el) {
                    el.textContent = `${customerName}, ${siteName} ${siteAddress}`;
                    console.log('‚úÖ customer-site-name:', el.textContent);
                }
                
                // Update all date fields
                const dateReport = document.getElementById('date-of-report');
                if (dateReport) dateReport.textContent = urlParams.get('date_of_report') || new Date().toLocaleDateString('en-GB');
                
                const ulrEl = document.getElementById('ulr-number');
                if (ulrEl) ulrEl.textContent = urlParams.get('ulr_number') || '';
                
                const refEl = document.getElementById('reference-number');
                if (refEl) refEl.textContent = urlParams.get('reference_number') || '';
                
                const jobEl = document.getElementById('job-code-number');
                if (jobEl) jobEl.textContent = urlParams.get('job_code_number') || '';
                
                const gradeEl = document.getElementById('grade-of-specimen');
                if (gradeEl) gradeEl.innerHTML = `<span class="highlight-text">${urlParams.get('grade_of_specimen') || 'M25'}</span>`;
                
                const ageEl = document.getElementById('age-of-specimen');
                if (ageEl) ageEl.innerHTML = `<div class="age-cell-content"><span class="highlight-text">${urlParams.get('age_of_specimen') || '28'}</span><div class="age-divider"></div><span>Days</span></div>`;
                
                const locationEl = document.getElementById('location-structure');
                if (locationEl) locationEl.textContent = urlParams.get('location_structure') || '';
                
                const machineEl = document.getElementById('machine-used');
                if (machineEl) {
                    machineEl.textContent = 'Fully automatic Digital Compression Testing Machine';
                    console.log('‚úÖ‚úÖ‚úÖ IMMEDIATE: Machine set to Fully automatic Digital Compression Testing Machine');
                }
                
                // Update BOTH test sample table AND result table
                console.log('üîÑ Updating BOTH tables for 3 cubes...');
                for (let i = 1; i <= 3; i++) {
                    // Sample table (dimensions, weight, load)
                    const idEl = document.getElementById(`sample-${i}-id`);
                    const blockId = urlParams.get(`block_id_${i}`) || '------';
                    if (idEl) {
                        idEl.textContent = blockId;
                        console.log(`‚úÖ sample-${i}-id:`, blockId);
                    }
                    
                    const lengthEl = document.getElementById(`sample-${i}-length`);
                    if (lengthEl) lengthEl.textContent = urlParams.get(`length_${i}`) || '';
                    
                    const breadthEl = document.getElementById(`sample-${i}-breadth`);
                    if (breadthEl) breadthEl.textContent = urlParams.get(`breadth_${i}`) || '';
                    
                    const heightEl = document.getElementById(`sample-${i}-height`);
                    if (heightEl) heightEl.textContent = urlParams.get(`height_${i}`) || '';
                    
                    const areaEl = document.getElementById(`sample-${i}-area`);
                    if (areaEl) areaEl.textContent = urlParams.get(`area_${i}`) || '';
                    
                    const weightEl = document.getElementById(`sample-${i}-weight`);
                    if (weightEl) weightEl.textContent = urlParams.get(`weight_${i}`) || '';
                    
                    const loadEl = document.getElementById(`sample-${i}-load`);
                    if (loadEl) loadEl.textContent = urlParams.get(`load_max_${i}`) || '';
                    
                    // Result table (density, compressive strength)
                    const resultIdEl = document.getElementById(`result-${i}-id`);
                    if (resultIdEl) {
                        resultIdEl.textContent = blockId;
                        console.log(`‚úÖ result-${i}-id:`, blockId);
                    }
                    
                    const densityEl = document.getElementById(`result-${i}-density`);
                    const densityVal = urlParams.get(`density_${i}`) || '';
                    if (densityEl) {
                        densityEl.textContent = densityVal;
                        console.log(`‚úÖ result-${i}-density:`, densityVal);
                    }
                    
                    const strengthEl = document.getElementById(`result-${i}-strength`);
                    const strengthVal = urlParams.get(`compressive_strength_${i}`) || '';
                    if (strengthEl) {
                        strengthEl.textContent = strengthVal;
                        console.log(`‚úÖ result-${i}-strength:`, strengthVal);
                    }
                }
                
                // Use SAVED average strength from database (NOT calculated!)
                const avgStrengthFromDB = urlParams.get('average_strength') || '0.00';
                const avgEl = document.getElementById('average-strength');
                if (avgEl) {
                    avgEl.innerHTML = `<span class="highlight-text">${avgStrengthFromDB}</span>`;
                    console.log('‚úÖ Average strength FROM DATABASE:', avgStrengthFromDB);
                }
                
                // Also update observation sheet average
                const obsAvgEl = document.getElementById('avg-compressive-strength');
                if (obsAvgEl) {
                    obsAvgEl.textContent = avgStrengthFromDB;
                    console.log('‚úÖ Observation sheet average updated:', avgStrengthFromDB);
                }
                
                // ===== UPDATE OBSERVATION SHEET (PAGE 1) - NEW CODE =====
                console.log('üìã Populating observation sheet (Page 1)...');
                
                // Auto-detect quantity from number of block_id parameters if not explicitly provided
                let quantity = parseInt(urlParams.get('quantity_of_blocks'));
                if (!quantity || isNaN(quantity)) {
                    // Count how many block_id_* parameters are present
                    quantity = 0;
                    for (let i = 1; i <= 6; i++) {
                        if (urlParams.get(`block_id_${i}`)) {
                            quantity++;
                        }
                    }
                    console.log('üìä Auto-detected quantity from block_id parameters:', quantity);
                }
                if (!quantity) quantity = 3; // Default fallback
                console.log('üìä Number of cubes for observation sheet:', quantity);
                
                // Define row mapping based on quantity:
                // 1 cube: row 1
                // 2 cubes: rows 1, 3
                // 3 cubes: rows 1, 3, 5
                // 4 cubes: rows 1, 2, 3, 4
                // 5 cubes: rows 1, 2, 3, 4, 5
                // 6 cubes: rows 1, 2, 3, 4, 5, 6
                
                // Map data index to row index
                let rowMapping;
                if (quantity === 1) {
                    rowMapping = [1];
                } else if (quantity === 2) {
                    rowMapping = [1, 3];
                } else if (quantity === 3) {
                    rowMapping = [1, 3, 5];
                } else if (quantity === 4) {
                    rowMapping = [1, 2, 3, 4];
                } else if (quantity === 5) {
                    rowMapping = [1, 2, 3, 4, 5];
                } else {
                    rowMapping = [1, 2, 3, 4, 5, 6];
                }
                
                // Populate data for each cube
                for (let dataIndex = 0; dataIndex < quantity; dataIndex++) {
                    const rowIndex = rowMapping[dataIndex];
                    const i = dataIndex + 1; // URL params are 1-indexed
                    
                    // Get data from URL params
                    const blockId = urlParams.get(`block_id_${i}`) || '';
                    const length = urlParams.get(`length_${i}`) || '';
                    const breadth = urlParams.get(`breadth_${i}`) || '';
                    const height = urlParams.get(`height_${i}`) || '';
                    const area = urlParams.get(`area_${i}`) || '';
                    const weight = urlParams.get(`weight_${i}`) || '';
                    const loadMax = urlParams.get(`load_max_${i}`) || '';
                    const compStrength = urlParams.get(`compressive_strength_${i}`) || '';
                    const failureType = urlParams.get(`failure_type_${i}`) || '';
                    
                    // Calculate size (format: length x breadth x height)
                    let size = '';
                    if (length && breadth && height) {
                        size = `${length}x${breadth}x${height}`;
                    }
                    
                    // Calculate density (kg/m¬≥)
                    // Formula: density = (weight * 1000) / (length * breadth * height)
                    let density = '';
                    if (weight && length && breadth && height) {
                        const weightKg = parseFloat(weight);
                        const lengthMm = parseFloat(length);
                        const breadthMm = parseFloat(breadth);
                        const heightMm = parseFloat(height);
                        
                        // Volume in cubic meters = (L * B * H) / 1000000000
                        const volumeM3 = (lengthMm * breadthMm * heightMm) / 1000000000;
                        const densityValue = weightKg / volumeM3;
                        density = densityValue.toFixed(3); // Format to 3 decimal places
                        console.log(`üìä Density calculation for cube ${i}:`, {weightKg, volumeM3, densityValue, density});
                    }
                    
                    // Populate serial number
                    const srNoEl = document.getElementById(`sr-no-${rowIndex}`);
                    if (srNoEl && blockId) {
                        srNoEl.textContent = dataIndex + 1;
                        console.log(`‚úÖ sr-no-${rowIndex}:`, dataIndex + 1);
                    }
                    
                    // Populate observation sheet fields (Page 1)
                    const blockIdEl = document.getElementById(`block-id-${rowIndex}`);
                    if (blockIdEl) {
                        blockIdEl.textContent = blockId;
                        console.log(`‚úÖ block-id-${rowIndex}:`, blockId);
                    }
                    
                    const sizeEl = document.getElementById(`size-${rowIndex}`);
                    if (sizeEl) {
                        sizeEl.textContent = size;
                        console.log(`‚úÖ size-${rowIndex}:`, size);
                    }
                    
                    const areaEl = document.getElementById(`area-${rowIndex}`);
                    if (areaEl) {
                        areaEl.textContent = area;
                        console.log(`‚úÖ area-${rowIndex}:`, area);
                    }
                    
                    const weightEl = document.getElementById(`weight-${rowIndex}`);
                    if (weightEl) {
                        weightEl.textContent = weight;
                        console.log(`‚úÖ weight-${rowIndex}:`, weight);
                    }
                    
                    const loadMaxEl = document.getElementById(`load-max-${rowIndex}`);
                    if (loadMaxEl) {
                        loadMaxEl.textContent = loadMax;
                        console.log(`‚úÖ load-max-${rowIndex}:`, loadMax);
                    }
                    
                    const densityEl = document.getElementById(`density-${rowIndex}`);
                    if (densityEl) {
                        densityEl.textContent = density;
                        console.log(`‚úÖ density-${rowIndex}:`, density);
                    }
                    
                    const compStrengthEl = document.getElementById(`compressive-strength-${rowIndex}`);
                    if (compStrengthEl) {
                        compStrengthEl.textContent = compStrength;
                        console.log(`‚úÖ compressive-strength-${rowIndex}:`, compStrength);
                    }
                    
                    const failureTypeEl = document.getElementById(`failure-type-${rowIndex}`);
                    if (failureTypeEl) {
                        failureTypeEl.textContent = failureType;
                        console.log(`‚úÖ failure-type-${rowIndex}:`, failureType);
                    }
                }
                console.log('‚úÖ Observation sheet populated with row mapping:', rowMapping);
                // ===== END OBSERVATION SHEET POPULATION =====
                
                // ===== UPDATE STRENGTH GRAPH (PAGE 4) - WITH RETRY =====
                setTimeout(() => {
                    const r7 = parseFloat(urlParams.get('required_7')) || 16;
                    const a7 = parseFloat(urlParams.get('actual_7')) || 20;
                    const r14 = parseFloat(urlParams.get('required_14')) || 30;
                    const a14 = parseFloat(urlParams.get('actual_14')) || 41;
                    const r28 = parseFloat(urlParams.get('required_28')) || 35;
                    const a28 = parseFloat(urlParams.get('actual_28')) || 45;
                    
                    console.log('üìä UPDATING GRAPH NOW! VALUES:', {r7, a7, r14, a14, r28, a28});
                    
                    const barsContainer = document.getElementById('bars-container');
                    console.log('üîç bars-container element:', barsContainer);
                    
                    if (barsContainer) {
                        const maxHeight = 200;
                        const maxStrength = 45;
                        const calcHeight = (val) => (val / maxStrength) * maxHeight;
                        
                        console.log('üìè Heights - 7d:', calcHeight(a7), '14d:', calcHeight(a14), '28d:', calcHeight(a28));
                        
                        barsContainer.innerHTML = `
                        <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                            <div style="display: flex; gap: 4px; align-items: flex-end;">
                                <div style="width: 50px; height: ${calcHeight(r7)}px; background-color: #4682B4;"></div>
                                <div style="width: 50px; height: ${calcHeight(a7)}px; background-color: #FFA500;"></div>
                            </div>
                            <div style="margin-top: 6px; font-size: 7pt; color: #000;">7 days strength</div>
                            <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                <span>${r7.toFixed(1)}</span>
                                <span>${a7.toFixed(2)}</span>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                            <div style="display: flex; gap: 4px; align-items: flex-end;">
                                <div style="width: 50px; height: ${calcHeight(r14)}px; background-color: #4682B4;"></div>
                                <div style="width: 50px; height: ${calcHeight(a14)}px; background-color: #FFA500;"></div>
                            </div>
                            <div style="margin-top: 6px; font-size: 7pt; color: #000;">14 days strength</div>
                            <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                <span>${r14.toFixed(1)}</span>
                                <span>${a14.toFixed(2)}</span>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                            <div style="display: flex; gap: 4px; align-items: flex-end;">
                                <div style="width: 50px; height: ${calcHeight(r28)}px; background-color: #4682B4;"></div>
                                <div style="width: 50px; height: ${calcHeight(a28)}px; background-color: #FFA500;"></div>
                            </div>
                            <div style="margin-top: 6px; font-size: 7pt; color: #000;">28 days strength</div>
                            <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                <span>${r28.toFixed(1)}</span>
                                <span>${a28.toFixed(2)}</span>
                            </div>
                        </div>
                    `;
                        console.log('‚úÖ‚úÖ‚úÖ GRAPH BARS UPDATED!');
                    } else {
                        console.error('‚ùå bars-container NOT FOUND!');
                    }
                    
                    // ===== UPDATE 6 OBSERVATIONS (PAGE 4) =====
                    const obs1 = urlParams.get('obs_strength_duration') || '--';
                    const obs2 = urlParams.get('obs_test_results') || '--';
                    const obs3 = urlParams.get('obs_weight') || '--';
                    const obs4 = urlParams.get('obs_failure_pattern') || '--';
                    const obs5 = urlParams.get('obs_bonding') || '--';
                    const obs6 = urlParams.get('obs_strength_criteria') || '--';
                    
                    const obsEls = [
                        document.getElementById('obs-strength-duration'),
                        document.getElementById('obs-test-results'),
                        document.getElementById('obs-weight'),
                        document.getElementById('obs-failure-pattern'),
                        document.getElementById('obs-bonding'),
                        document.getElementById('obs-strength-criteria')
                    ];
                    const obsVals = [obs1, obs2, obs3, obs4, obs5, obs6];
                    
                    obsEls.forEach((el, i) => {
                        if (el) {
                            el.textContent = obsVals[i];
                            console.log(`‚úÖ Observation ${i+1}:`, obsVals[i]);
                        }
                    });
                    
                    // ===== HIDE EMPTY ROWS BASED ON QUANTITY =====
                    const quantity = parseInt(urlParams.get('quantity_of_blocks')) || 3;
                    console.log('üìä Number of cubes:', quantity);
                    
                    // Hide cube rows that don't have data (in ALL tables)
                    if (quantity < 3) {
                        // Hide images row 3
                        const cube3Row = document.getElementById('cube3-row');
                        if (cube3Row) cube3Row.style.display = 'none';
                        
                        // Hide result row 3
                        const result3Row = document.getElementById('result-row-3');
                        if (result3Row) result3Row.style.display = 'none';
                        
                        // Hide sample row 3
                        const sample3Row = document.getElementById('sample-row-3');
                        if (sample3Row) sample3Row.style.display = 'none';
                    }
                    if (quantity < 2) {
                        // Hide images row 2
                        const cube2Row = document.getElementById('cube2-row');
                        if (cube2Row) cube2Row.style.display = 'none';
                        
                        // Hide result row 2
                        const result2Row = document.getElementById('result-row-2');
                        if (result2Row) result2Row.style.display = 'none';
                        
                        // Hide sample row 2
                        const sample2Row = document.getElementById('sample-row-2');
                        if (sample2Row) sample2Row.style.display = 'none';
                    }
                    
                    // Update rowspan on average cell
                    const avgCell = document.getElementById('average-strength');
                    if (avgCell) {
                        avgCell.setAttribute('rowspan', quantity);
                    }
                    
                    console.log(`‚úÖ Hiding rows for quantity=${quantity}`);
                    
                    // Update grade header
                    const gradeHeader = document.getElementById('grade-header');
                    if (gradeHeader) {
                        const grade = urlParams.get('grade_of_specimen') || 'M-25';
                        gradeHeader.textContent = `GRADE OF CONCRETE: ${grade}`;
                    }
                    
                    // ===== UPDATE IMAGES (PAGE 3) FROM sessionStorage =====
                    const testRequestId = urlParams.get('test_request_id') || '248';
                    const imagesJson = sessionStorage.getItem('testImages_' + testRequestId);
                    
                    if (imagesJson) {
                        try {
                            const images = JSON.parse(imagesJson);
                            console.log('üì∏ Loaded images from sessionStorage:', Object.keys(images));
                            
                            // Update cube images only for quantity
                            for (let i = 1; i <= quantity; i++) {
                                const frontImg = images[`front_failure_${i}`];
                                const screenImg = images[`digital_reading_${i}`];
                                const backImg = images[`back_failure_${i}`];
                                
                                const frontEl = document.getElementById(`cube${i}-front-img`);
                                if (frontEl && frontImg) {
                                    frontEl.src = frontImg;
                                    console.log(`‚úÖ Updated cube${i} front image`);
                                }
                                
                                const screenEl = document.getElementById(`cube${i}-screen-img`);
                                if (screenEl && screenImg) {
                                    screenEl.src = screenImg;
                                    console.log(`‚úÖ Updated cube${i} screen image`);
                                }
                                
                                const backEl = document.getElementById(`cube${i}-back-img`);
                                if (backEl && backImg) {
                                    backEl.src = backImg;
                                    console.log(`‚úÖ Updated cube${i} back image`);
                                }
                            }
                            
                            console.log('‚úÖ Images updated from sessionStorage!');
                        } catch (e) {
                            console.error('‚ùå Error loading images:', e);
                        }
                    } else {
                        console.warn('‚ö†Ô∏è No images found in sessionStorage for test:', testRequestId);
                    }
                    
                    console.log('‚úÖ‚úÖ‚úÖ ALL DATA UPDATED - TABLES, GRAPH, OBSERVATIONS, IMAGES!');
                }, 500); // Wait 500ms for pages to be visible
                
                // SECOND ATTEMPT - Force update graph again after 1 second
                setTimeout(() => {
                    console.log('üîÅ SECOND ATTEMPT - Updating graph again...');
                    const barsContainer2 = document.getElementById('bars-container');
                    console.log('üîç Second attempt - bars-container found:', !!barsContainer2);
                    
                    if (barsContainer2) {
                        const r7 = parseFloat(urlParams.get('required_7')) || 16;
                        const a7 = parseFloat(urlParams.get('actual_7')) || 20;
                        const r14 = parseFloat(urlParams.get('required_14')) || 30;
                        const a14 = parseFloat(urlParams.get('actual_14')) || 41;
                        const r28 = parseFloat(urlParams.get('required_28')) || 35;
                        const a28 = parseFloat(urlParams.get('actual_28')) || 45;
                        
                        const maxHeight = 200;
                        const maxStrength = 45;
                        const calcHeight = (val) => (val / maxStrength) * maxHeight;
                        
                        barsContainer2.innerHTML = `
                            <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                <div style="display: flex; gap: 4px; align-items: flex-end;">
                                    <div style="width: 50px; height: ${calcHeight(r7)}px; background-color: #4682B4;"></div>
                                    <div style="width: 50px; height: ${calcHeight(a7)}px; background-color: #FFA500;"></div>
                                </div>
                                <div style="margin-top: 6px; font-size: 7pt; color: #000;">7 days strength</div>
                                <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>${r7.toFixed(1)}</span>
                                    <span>${a7.toFixed(2)}</span>
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                <div style="display: flex; gap: 4px; align-items: flex-end;">
                                    <div style="width: 50px; height: ${calcHeight(r14)}px; background-color: #4682B4;"></div>
                                    <div style="width: 50px; height: ${calcHeight(a14)}px; background-color: #FFA500;"></div>
                                </div>
                                <div style="margin-top: 6px; font-size: 7pt; color: #000;">14 days strength</div>
                                <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>${r14.toFixed(1)}</span>
                                    <span>${a14.toFixed(2)}</span>
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                <div style="display: flex; gap: 4px; align-items: flex-end;">
                                    <div style="width: 50px; height: ${calcHeight(r28)}px; background-color: #4682B4;"></div>
                                    <div style="width: 50px; height: ${calcHeight(a28)}px; background-color: #FFA500;"></div>
                                </div>
                                <div style="margin-top: 6px; font-size: 7pt; color: #000;">28 days strength</div>
                                <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                    <span>${r28.toFixed(1)}</span>
                                    <span>${a28.toFixed(2)}</span>
                                </div>
                            </div>
                        `;
                        console.log('‚úÖ‚úÖ‚úÖ SECOND ATTEMPT - GRAPH UPDATED!');
                    } else {
                        console.error('‚ùå bars-container STILL NOT FOUND after 1 second!');
                        console.log('Available element IDs:', Array.from(document.querySelectorAll('[id]')).map(el => el.id));
                    }
                }, 1000);
                
                // THIRD ATTEMPT - 2 second delay
                setTimeout(() => {
                    console.log('üîÅüîÅ THIRD ATTEMPT - Final retry...');
                    const all = document.querySelectorAll('[id]');
                    console.log('All elements with IDs:', Array.from(all).map(el => el.id));
                    
                    const bars3 = document.getElementById('bars-container');
                    if (bars3) {
                        console.log('‚úÖ FOUND IT ON THIRD TRY!');
                        const r7 = parseFloat(urlParams.get('required_7')) || 0;
                        const a7 = parseFloat(urlParams.get('actual_7')) || 0;
                        const r14 = parseFloat(urlParams.get('required_14')) || 0;
                        const a14 = parseFloat(urlParams.get('actual_14')) || 0;
                        const r28 = parseFloat(urlParams.get('required_28')) || 0;
                        const a28 = parseFloat(urlParams.get('actual_28')) || 0;
                        
                        console.log('FINAL VALUES:', {r7, a7, r14, a14, r28, a28});
                        
                        if (r7 > 0 || a7 > 0) {
                            const calcHeight = (val) => (val / 45) * 200;
                            bars3.innerHTML = `
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                                        <div style="width: 50px; height: ${calcHeight(r7)}px; background-color: #4682B4;"></div>
                                        <div style="width: 50px; height: ${calcHeight(a7)}px; background-color: #FFA500;"></div>
                                    </div>
                                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">7 days strength</div>
                                    <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                        <span>${r7}</span>
                                        <span>${a7}</span>
                                    </div>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                                        <div style="width: 50px; height: ${calcHeight(r14)}px; background-color: #4682B4;"></div>
                                        <div style="width: 50px; height: ${calcHeight(a14)}px; background-color: #FFA500;"></div>
                                    </div>
                                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">14 days strength</div>
                                    <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                        <span>${r14}</span>
                                        <span>${a14}</span>
                                    </div>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                                        <div style="width: 50px; height: ${calcHeight(r28)}px; background-color: #4682B4;"></div>
                                        <div style="width: 50px; height: ${calcHeight(a28)}px; background-color: #FFA500;"></div>
                                    </div>
                                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">28 days strength</div>
                                    <div style="margin-top: 3px; font-size: 7pt; color: #000; display: flex; flex-direction: column; line-height: 1.3;">
                                        <span>${r28}</span>
                                        <span>${a28}</span>
                                    </div>
                                </div>
                            `;
                            console.log('üéâüéâüéâ GRAPH FINALLY UPDATED ON THIRD TRY!');
                        }
                    } else {
                        console.error('üíÄ BARS CONTAINER NOT FOUND EVEN ON THIRD TRY!');
                    }
                }, 2000);
            });
        })();
    </script>
    
    <!-- PAGE 1: OBSERVATION REPORT -->
    <div class="page" id="page1">
        <table class="header-table">
            <tr>
                <td class="logo-cell"><img src="/logo.png" alt="Vitrag Associates logo"></td>
                <td class="title-cell">
                    <h1>VITRAG ASSOCIATES LLP</h1>
                    <div class="subtitle">(CONSTRUCTION MATERIAL TESTING LABORATORY)</div>
                </td>
            </tr>
        </table>

        <div class="meta-wrap">
            <table class="meta">
                <tr>
                    <td colspan="4" style="text-align:center; font-weight:bold; text-decoration:underline; font-size:21.33px; height:1cm;">COMPRESSIVE STRENGTH OF CONCRETE CUBE</td>
                </tr>
                <tr>
                    <td><strong>Sample Test Code Number</strong></td>
                    <td id="sample-test-code"></td>
                    <td><strong>Sample Description</strong></td>
                    <td id="sample-description"></td>
                </tr>
                <tr>
                    <td><strong>Quantity of Cubes</strong></td>
                    <td id="quantity-of-blocks"></td>
                    <td><strong>Date of Receipt</strong></td>
                    <td id="date-of-receipt"></td>
                </tr>
                <tr>
                    <td><strong>Date of Casting</strong></td>
                    <td id="date-of-casting"></td>
                    <td><strong>Date of Testing</strong></td>
                    <td id="date-of-testing"></td>
                </tr>
                <tr>
                    <td><strong>Grade of Cube</strong></td>
                    <td id="grade-of-blocks"></td>
                    <td><strong>Cube Condition</strong></td>
                    <td id="blocks-condition"></td>
                </tr>
                <tr>
                    <td><strong>Age of Cube</strong></td>
                    <td id="manufacture-of-blocks"></td>
                    <td><strong>Curing Condition</strong></td>
                    <td id="curing-condition"></td>
                </tr>
                <tr>
                    <td><strong>Machine used for Testing</strong></td>
                    <td id="machine-used-for-testing"></td>
                    <td><strong>Test Method</strong></td>
                    <td id="test-method"></td>
                </tr>
            </table>
        </div>

        <div class="test-result">
            <table class="results">
                <thead>
                    <tr>
                        <td colspan="9" style="text-align:center; font-weight:bold; text-decoration:underline; font-size:21px; height:0.6cm;">TEST RESULT</td>
                    </tr>
                    <tr>
                        <th rowspan="2">Sr. No.</th>
                        <th rowspan="2">Cube ID</th>
                        <th>Size</th>
                        <th>Area</th>
                        <th>Cube Weight</th>
                        <th>Maximum Load</th>
                        <th>Density</th>
                        <th>Compressive Strength</th>
                        <th>Type of Failure</th>
                    </tr>
                    <tr>
                        <th>mm</th>
                        <th>mm¬≤</th>
                        <th>Kg</th>
                        <th>KN</th>
                        <th>kg/m¬≥</th>
                        <th>Mpa</th>
                        <th>-</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="sr-no-1"></td>
                        <td id="block-id-1"></td>
                        <td id="size-1"></td>
                        <td id="area-1"></td>
                        <td id="weight-1"></td>
                        <td id="load-max-1"></td>
                        <td id="density-1"></td>
                        <td id="compressive-strength-1"></td>
                        <td id="failure-type-1"></td>
                    </tr>
                    <tr>
                        <td id="sr-no-2"></td>
                        <td id="block-id-2"></td>
                        <td id="size-2"></td>
                        <td id="area-2"></td>
                        <td id="weight-2"></td>
                        <td id="load-max-2"></td>
                        <td id="density-2"></td>
                        <td id="compressive-strength-2"></td>
                        <td id="failure-type-2"></td>
                    </tr>
                    <tr>
                        <td id="sr-no-3"></td>
                        <td id="block-id-3"></td>
                        <td id="size-3"></td>
                        <td id="area-3"></td>
                        <td id="weight-3"></td>
                        <td id="load-max-3"></td>
                        <td id="density-3"></td>
                        <td id="compressive-strength-3"></td>
                        <td id="failure-type-3"></td>
                    </tr>
                    <tr>
                        <td id="sr-no-4"></td>
                        <td id="block-id-4"></td>
                        <td id="size-4"></td>
                        <td id="area-4"></td>
                        <td id="weight-4"></td>
                        <td id="load-max-4"></td>
                        <td id="density-4"></td>
                        <td id="compressive-strength-4"></td>
                        <td id="failure-type-4"></td>
                    </tr>
                    <tr>
                        <td id="sr-no-5"></td>
                        <td id="block-id-5"></td>
                        <td id="size-5"></td>
                        <td id="area-5"></td>
                        <td id="weight-5"></td>
                        <td id="load-max-5"></td>
                        <td id="density-5"></td>
                        <td id="compressive-strength-5"></td>
                        <td id="failure-type-5"></td>
                    </tr>
                    <tr>
                        <td id="sr-no-6"></td>
                        <td id="block-id-6"></td>
                        <td id="size-6"></td>
                        <td id="area-6"></td>
                        <td id="weight-6"></td>
                        <td id="load-max-6"></td>
                        <td id="density-6"></td>
                        <td id="compressive-strength-6"></td>
                        <td id="failure-type-6"></td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="7">Average</td>
                        <td id="avg-compressive-strength" style="font-weight: bold; text-align: center;"></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr>
                        <td colspan="9" style="text-align:left; padding:12px; height:40mm; vertical-align:top; font-size:16px;">
                            <div style="font-weight:bold; margin-bottom:8px; font-size:18px;">Remarks:</div>
                            <div id="remarks-content" style="font-size:16px; min-height: 30mm; max-height: 30mm; overflow: hidden;"></div>
                        </td>
                    </tr>
                </tfoot>
            </table>

            <!-- SEPARATE SIGNATURE TABLE -->
            <table class="signature-table">
                <tbody>
                    <!-- Signature Table - Title Row -->
                    <tr class="signature-row-title">
                        <td class="signature-cell-title">Tested By: <span id="tested-by-name" class="signature-name"></span></td>
                        <td class="signature-cell-title">Checked By: <span id="checked-by-name" class="signature-name"></span></td>
                        <td class="signature-cell-title">Verified By: <span id="verified-by-name" class="signature-name"></span></td>
                    </tr>
                    <!-- Signature Table - Date Row -->
                    <tr class="signature-row-date">
                        <td class="signature-cell-date">Date: <span id="tested-by-date"></span></td>
                        <td class="signature-cell-date">Date: <span id="checked-by-date"></span></td>
                        <td class="signature-cell-date">Date: <span id="verified-by-date"></span></td>
                    </tr>
                    <!-- Signature Table - Sign Row -->
                    <tr class="signature-row-sign">
                        <td class="signature-cell-sign">Sign:</td>
                        <td class="signature-cell-sign">Sign:</td>
                        <td class="signature-cell-sign">Sign:</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- PAGE 2: TEST REPORT -->
    <div class="page" id="page2">
        <!-- Header Section - 3 Column Flexbox -->
        <div class="header">
            <!-- Left Column - Company Logo -->
            <div class="header-left">
                <div class="logo-left">
                    <img src="/logo.png" alt="Vitrag Associates Logo">
                </div>
            </div>

            <!-- Center Column - Company Name and Report Title -->
            <div class="header-center">
                <div class="company-name">VITRAG ASSOCIATES LLP</div>
                <div class="company-subtitle">(Construction Material Testing Laboratory)</div>
                <div class="header-divider"></div>
                <div class="report-title-header-page1">TEST REPORT</div>
            </div>

            <!-- Right Column - NABL Logo and Certificate Number -->
            <div class="header-right">
                <div class="logo-right">
                    <img src="/nabl_logo_final.png" alt="NABL Logo">
                </div>
                <div class="certificate-number">TC-15756</div>
            </div>
        </div>

        <!-- Details Table -->
        <table class="details-table">
            <tr>
                <td rowspan="2">Customer/Site Name & Address</td>
                <td rowspan="2" id="customer-site-name">Lords Developers Shivyogi Residency, shelgi solapur</td>
                <td>Date of Report</td>
                <td id="date-of-report">23/09/2025</td>
            </tr>
            <tr>
                <td>ULR Number</td>
                <td id="ulr-number">TC-1575625000001840F</td>
            </tr>
            <tr>
                <td>Reference Number</td>
                <td id="reference-number">VA/CC/2025/AUG-74</td>
                <td>Job Code Number</td>
                <td id="job-code-number">T-2501690</td>
            </tr>
            <tr>
                <td>Location/Structure Type</td>
                <td id="location-structure">column</td>
                <td>Age of Specimen</td>
                <td id="age-of-specimen">
                    <div class="age-cell-content">
                        <span class="highlight-text">28</span>
                        <div class="age-divider"></div>
                        <span>Days</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>Date of Receipt</td>
                <td id="date-of-receipt">25/08/2025</td>
                <td>Date of Casting</td>
                <td id="date-of-casting"><span class="highlight-text">11/08/2025</span></td>
            </tr>
            <tr>
                <td>Date of Testing</td>
                <td id="date-of-testing">08/09/2025</td>
                <td>Type of Specimen</td>
                <td id="type-of-specimen">Concrete Cube</td>
            </tr>
            <tr>
                <td>Grade of Specimen</td>
                <td id="grade-of-specimen"><span class="highlight-text">M-25</span></td>
                <td>Condition of Specimen</td>
                <td id="condition-of-specimen">Acceptable</td>
            </tr>
            <tr>
                <td>Machine used for Testing</td>
                <td id="machine-used" colspan="3">Fully automatic Digital Compression Testing Machine</td>
            </tr>
            <tr>
                <td>Capacity Range</td>
                <td id="capacity-range">2000KN</td>
                <td>Calibration Due Date</td>
                <td id="calibration-due-date">01/07/2026</td>
            </tr>
            <tr>
                <td>Test Method</td>
                <td id="test-method">IS 516 (Part1/Sec1):2021</td>
                <td>Environmental condition</td>
                <td id="environmental-condition">Not Applicable</td>
            </tr>
        </table>

        <!-- Sample Description Table -->
        <table class="sample-table">
            <tr>
                <td class="grade-header" colspan="2"><span class="grade-text" id="grade-header">GRADE OF CONCRETE: M-25</span></td>
                <td class="table-title" colspan="6">DESCRIPTION OF TEST SAMPLE</td>
            </tr>
            <tr>
                <th>Sr. No. </th>
                <th>ID Mark</th>
                <th colspan="3">Dimensions (mm)<br>(L √ó B √ó H)</th>
                <th>Area (mm¬≤)</th>
                <th>Weight (kg)</th>
                <th>Max Load (kN)</th>
            </tr>
            <tr id="sample-row-1">
                <td>1</td>
                <td id="sample-1-id">------</td>
                <td id="sample-1-length">150.4</td>
                <td id="sample-1-breadth">150.7</td>
                <td id="sample-1-height">150.1</td>
                <td id="sample-1-area">22665.28</td>
                <td id="sample-1-weight">9.1</td>
                <td id="sample-1-load">265.4</td>
            </tr>
            <tr id="sample-row-2">
                <td>2</td>
                <td id="sample-2-id">------</td>
                <td id="sample-2-length">150.1</td>
                <td id="sample-2-breadth">149.9</td>
                <td id="sample-2-height">150.1</td>
                <td id="sample-2-area">22499.99</td>
                <td id="sample-2-weight">9.0</td>
                <td id="sample-2-load">297.4</td>
            </tr>
            <tr id="sample-row-3">
                <td>3</td>
                <td id="sample-3-id">------</td>
                <td id="sample-3-length">150.8</td>
                <td id="sample-3-breadth">150.1</td>
                <td id="sample-3-height">150.3</td>
                <td id="sample-3-area">22635.08</td>
                <td id="sample-3-weight">9.0</td>
                <td id="sample-3-load">321.7</td>
            </tr>
        </table>

        <!-- Test Result Table -->
        <div class="test-result-title">Test Result for Density and Compressive Strength of Concrete Cubes</div>
        <table class="test-result-table">
            <tr>
                <th>Sr. No.</th>
                <th>ID Mark</th>
                <th>Density (kg/m¬≥)</th>
                <th>Compressive Strength (N/mm¬≤)</th>
                <th>Average Compressive Strength (N/mm¬≤)</th>
            </tr>
            <tr id="result-row-1">
                <td>1</td>
                <td id="result-1-id">C1</td>
                <td id="result-1-density">2400</td>
                <td id="result-1-strength">25.5</td>
                <td rowspan="3" class="highlight-cell" id="average-strength"><span class="highlight-text">25.47</span></td>
            </tr>
            <tr id="result-row-2">
                <td>2</td>
                <td id="result-2-id">C2</td>
                <td id="result-2-density">2410</td>
                <td id="result-2-strength">26.1</td>
            </tr>
            <tr id="result-row-3">
                <td>3</td>
                <td id="result-3-id">C3</td>
                <td id="result-3-density">2390</td>
                <td id="result-3-strength">24.8</td>
            </tr>
        </table>

        <!-- Terms & Conditions -->
        <div class="terms-section">
            <h4>Terms & Conditions ‚Äì</h4>
            <ol>
                <li>Samples were not drawn by Vitrag Associates LLP lab.</li>
                <li>The Test Reports & Results pertain to Sample/ Samples of material received by Vitrag Associates LLP.
                </li>
                <li>The Test Report cannot be reproduced without the written approval of CEO/QM of Vitrag Associates
                    LLP.</li>
                <li>Any change/ correction/ alteration to the Test Report shall be invalid.</li>
                <li>The role Vitrag Associates LLP is restricted to testing of the material sample as received in the
                    laboratory. Vitrag Associates LLP or any of its employees shall not be liable for any dispute/
                    litigation arising between the customer & Third Party on account of test results. Vitrag Associates
                    LLP shall not interact with any Third Party in this regard.</li>
                <li>The CEO of Vitrag Associates LLP may make necessary changes to the terms & conditions without any
                    prior notice.</li>
            </ol>
        </div>

        <!-- Signature Section -->
        <div class="signature-section">
            <!-- Left side -->
            <div class="reviewed-section">
                <div class="title">Reviewed by -</div>
                <div class="name">Lalita S. Dussa</div>
                <div class="subtitle">(Quality Manager)</div>
                <div class="details">B.Tech.(Civil)</div>
            </div>

            <!-- Middle stamp -->
            <div class="stamp-section">
                <img src="/stamp_clear.png" alt="Stamp" class="stamp">
            </div>

            <!-- Right side -->
            <div class="authorized-section">
                <div class="title">Authorized by -</div>
                <div class="name">Mr. Prakarsh A Sangave</div>
                <div class="subtitle">(Chief Executive Officer)</div>
                <div class="qualification-1">M.E (Civil-Structures)</div>
                <div class="qualification-2">M.Tech (Civil-Geotechnical), M.I.E, F.I.E.</div>
            </div>
        </div>

        <!-- Footer Section -->
        <div class="footer">
            <div class="footer-divider">X‚Äî‚Äî‚ÄîX‚Äî‚Äî‚ÄîX‚Äî‚Äî‚Äî END OF REPORT ‚Äî‚ÄîX‚Äî‚Äî‚ÄîX‚Äî‚Äî‚ÄîX</div>
            <div class="footer-content">
                <div class="footer-left">
                    VA/TR/I-3/24
                </div>
                <div class="footer-center">
                    34A/26 West, New Pachha Peth, Ashok Chowk, Solapur <br>
                    Mob. No.-9552529235, 9145153496, E-mail: vitragassociates3@gmail.com
                </div>
                <div class="footer-right">
                    Page 1 of 3 <br>
                    Issue No. 03
                </div>
            </div>
        </div>
    </div>

    <!-- PAGE 3 - A4 Size -->
    <div class="page" id="page3">
        <!-- Header Section - 3 Column Flexbox -->
        <div class="header">
            <!-- Left Column - Company Logo -->
            <div class="header-left">
                <div class="logo-left">
                    <img src="/logo.png" alt="Vitrag Associates Logo">
                </div>
            </div>

            <!-- Center Column - Company Name and Report Title -->
            <div class="header-center">
                <div class="company-name">VITRAG ASSOCIATES LLP</div>
                <div class="company-subtitle">(Construction Material Testing Laboratory)</div>
                <div class="header-divider-extended"></div>
                <div class="report-title-header">ANNEXURE - I</div>
            </div>

            <!-- Right Column - Empty for pages 2 and 3 -->
            <div class="header-right">
                <!-- NABL logo removed for pages 2 and 3 -->
            </div>
        </div>

        <!-- ANNEXURE - I Content -->
        <div class="annexure-content">
            <!-- Main Table -->
            <table class="annexure-table">
                <thead>
                    <tr>
                        <th>Pictorial View of Front side failure of cube specimen</th>
                        <th>Digital reading of Load & Compressive Strength</th>
                        <th>Pictorial View of Back side failure of Cube Specimen</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><img id="cube1-front-img" src="/cube1_front.jpg" alt="Cube 1 Front" class="annexure-image"></td>
                        <td><img id="cube1-screen-img" src="/cube1_screen.jpg" alt="Cube 1 Screen" class="annexure-image"></td>
                        <td><img id="cube1-back-img" src="/cube1_back.jpg" alt="Cube 1 Back" class="annexure-image"></td>
                    </tr>
                    <tr id="cube2-row">
                        <td><img id="cube2-front-img" src="/cube2_front.jpg" alt="Cube 2 Front" class="annexure-image"></td>
                        <td><img id="cube2-screen-img" src="/cube2_screen.jpg" alt="Cube 2 Screen" class="annexure-image"></td>
                        <td><img id="cube2-back-img" src="/cube2_back.jpg" alt="Cube 2 Back" class="annexure-image"></td>
                    </tr>
                    <tr id="cube3-row">
                        <td><img id="cube3-front-img" src="/cube3_front.jpg" alt="Cube 3 Front" class="annexure-image"></td>
                        <td><img id="cube3-screen-img" src="/cube3_screen.jpg" alt="Cube 3 Screen" class="annexure-image"></td>
                        <td><img id="cube3-back-img" src="/cube3_back.jpg" alt="Cube 3 Back" class="annexure-image"></td>
                    </tr>
                </tbody>
            </table>

            <!-- Caption -->
            <div class="annexure-caption">
                Fig 1 - Pictorial view of Failure Pattern of Concrete Cube with Digital Readings
            </div>

            <!-- Formula Box -->
            <div class="formula-box">
                <div class="formula-text">
                    <div style="text-align: left; font-size: 16px;">
                        <strong>Compressive Strength = </strong>
                        <span class="math-fraction">
                            <span class="math-numerator">P</span>
                            <span class="math-denominator">LB</span>
                        </span>
                        <strong> = </strong>
                        <span class="math-fraction">
                            <span class="math-numerator">Peak Load (N)</span>
                            <span class="math-denominator">Surface Area (mm¬≤)</span>
                        </span>
                    </div>
                </div>
            </div>

            <!-- Test Witnessed Section -->
            <div class="test-witnessed">
                TEST WITNESSED:
            </div>
        </div>

        <!-- Footer for Page 2 -->
        <div class="footer">
            <div class="footer-content">
                <div class="footer-left">
                    VA/TR/I-3/24
                </div>
                <div class="footer-center">
                    34A/26 West, New Pachha Peth, Ashok Chowk, Solapur <br>
                    Mob. No.-9552529235, 9145153496, E-mail: vitragassociates3@gmail.com
                </div>
                <div class="footer-right">
                    Page 2 of 3 <br>
                    Issue No. 03
                </div>
            </div>
        </div>
    </div>

    <!-- PAGE 4 - A4 Size -->
    <div class="page" id="page4">
        <!-- Header Section - 3 Column Flexbox -->
        <div class="header">
            <!-- Left Column - Company Logo -->
            <div class="header-left">
                <div class="logo-left">
                    <img src="/logo.png" alt="Vitrag Associates Logo">
                </div>
            </div>

            <!-- Center Column - Company Name and Report Title -->
            <div class="header-center">
                <div class="company-name">VITRAG ASSOCIATES LLP</div>
                <div class="company-subtitle">(Construction Material Testing Laboratory)</div>
                <div class="header-divider-extended"></div>
                <div class="report-title-header">Observations</div>
            </div>

            <!-- Right Column - Empty for pages 2 and 3 -->
            <div class="header-right">
                <!-- NABL logo removed for pages 2 and 3 -->
            </div>
        </div>

        <!-- Observations Content -->
        <div class="observations-content">
            <!-- Observations Table -->
            <table class="observations-table">
                <tbody>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">1</td>
                        <td style="width: 70%;">Compressive Strength acquired after specified duration</td>
                        <td id="obs-strength-duration" style="width: 25%; text-align: center;">--</td>
                    </tr>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">2</td>
                        <td style="width: 70%;">Individual test results within ¬±15% of average strength</td>
                        <td id="obs-test-results" style="width: 25%; text-align: center;">--</td>
                    </tr>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">3</td>
                        <td style="width: 70%;">Weight of cube</td>
                        <td id="obs-weight" style="width: 25%; text-align: center;">--</td>
                    </tr>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">4</td>
                        <td style="width: 70%;">Type of failure Pattern as per IS 516(Part-1/Sec-1): - 2021 Fig 1</td>
                        <td id="obs-failure-pattern" style="width: 25%; text-align: center;">--</td>
                    </tr>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">5</td>
                        <td style="width: 70%;">Bonding between Aggregates and cement paste.</td>
                        <td id="obs-bonding" style="width: 25%; text-align: center;">--</td>
                    </tr>
                    <tr>
                        <td style="width: 5%; text-align: center; font-weight: bold;">6</td>
                        <td style="width: 70%;">Compressive Strength as per acceptance criteria as C1,16.1 of IS 456:2000 (Fck+4) From Table No.11</td>
                        <td id="obs-strength-criteria" style="width: 25%; text-align: center;">--</td>
                    </tr>
                </tbody>
            </table>

            <!-- Bar Chart Section -->
            <div class="chart-container">
                <div class="bar-chart" id="strength-graph-container">
                    <!-- Pure CSS/JS Strength Graph -->
                    <div style="font-family: 'Times New Roman', Times, serif; padding: 10px; position: relative; width: 100%; height: 100%;">
                        <!-- DEBUG INFO -->
                        <div id="debug-info" style="font-size: 8pt; color: red; text-align: center; margin-bottom: 5px;"></div>
                        
                        <!-- Chart Container -->
                        <div style="position: relative; width: calc(100% - 30px); height: 230px; margin: 0 auto;">
                            <!-- Y-axis -->
                            <div style="position: absolute; left: 70px; top: 10px; height: 200px; border-left: 2px solid #000;">
                                <!-- Y-axis labels - Static -->
                                <div style="position: absolute; right: 10px; top: 0%; transform: translateY(-50%); font-size: 7pt; color: #000;">45</div>
                                <div style="position: absolute; right: 10px; top: 11.1%; transform: translateY(-50%); font-size: 7pt; color: #000;">40</div>
                                <div style="position: absolute; right: 10px; top: 22.2%; transform: translateY(-50%); font-size: 7pt; color: #000;">35</div>
                                <div style="position: absolute; right: 10px; top: 33.3%; transform: translateY(-50%); font-size: 7pt; color: #000;">30</div>
                                <div style="position: absolute; right: 10px; top: 44.4%; transform: translateY(-50%); font-size: 7pt; color: #000;">25</div>
                                <div style="position: absolute; right: 10px; top: 55.6%; transform: translateY(-50%); font-size: 7pt; color: #000;">20</div>
                                <div style="position: absolute; right: 10px; top: 66.7%; transform: translateY(-50%); font-size: 7pt; color: #000;">15</div>
                                <div style="position: absolute; right: 10px; top: 77.8%; transform: translateY(-50%); font-size: 7pt; color: #000;">10</div>
                                <div style="position: absolute; right: 10px; top: 88.9%; transform: translateY(-50%); font-size: 7pt; color: #000;">5</div>
                                <div style="position: absolute; right: 10px; top: 100%; transform: translateY(-50%); font-size: 7pt; color: #000;">0</div>
                                
                                <!-- Grid lines -->
                                <div style="position: absolute; left: 0; top: 11.1%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 22.2%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 33.3%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 44.4%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 55.6%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 66.7%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 77.8%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 88.9%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                                <div style="position: absolute; left: 0; top: 100%; width: calc(100% - 80px); max-width: 600px; border-top: 1px solid rgba(0,0,0,0.15);"></div>
                            </div>
                            
                            <!-- X-axis line -->
                            <div style="position: absolute; left: 70px; top: 210px; width: calc(100% - 80px); max-width: 600px; border-bottom: 2px solid #000;"></div>
                            
                            <!-- Bars Container -->
                            <div id="bars-container" style="position: absolute; left: 75px; bottom: -25px; width: calc(100% - 85px); max-width: 595px; height: 200px; display: flex; justify-content: space-around; align-items: flex-end;">
                                <!-- Bars will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Y-axis label -->
                        <div style="position: absolute; left: 8px; top: 120px; transform: rotate(-90deg); transform-origin: center; font-size: 11pt; color: #000; letter-spacing: 1px; font-weight: 500;">
                            Strength N/mm2
                        </div>
                        
                        <!-- Legend - Left Side -->
                        <div style="position: absolute; left: 5px; bottom: 25px; font-size: 7pt; line-height: 1.5; color: #000;">
                            <div style="display: flex; align-items: center; gap: 5px; margin-bottom: 4px;">
                                <div style="width: 15px; height: 10px; background-color: #4682B4;"></div>
                                <span>Required strength N/mm2</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <div style="width: 15px; height: 10px; background-color: #FFA500;"></div>
                                <span>Actual Cube strength</span>
                            </div>
                        </div>
                        
                        <!-- Legend - Bottom Center -->
                        <div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; gap: 40px; font-size: 7pt; color: #000;">
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <div style="width: 18px; height: 10px; background-color: #4682B4;"></div>
                                <span>Required strength N/mm2</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <div style="width: 18px; height: 10px; background-color: #FFA500;"></div>
                                <span>Actual Cube strength</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chart-caption">Fig. 2 - Graphical Representation of Comparison of Compressive Strengths</div>
            </div>
        </div>

        <!-- Signature Section for Page 3 -->
        <div class="signature-section">
            <!-- Left side -->
            <div class="reviewed-section">
                <div class="title">Reviewed by -</div>
                <div class="name">Lalita S. Dussa</div>
                <div class="subtitle">(Quality Manager)</div>
                <div class="details">B.Tech.(Civil)</div>
            </div>

            <!-- Middle stamp -->
            <div class="stamp-section">
                <img src="/stamp_clear.png" alt="Stamp" class="stamp">
            </div>

            <!-- Right side -->
            <div class="authorized-section">
                <div class="title">Authorized by -</div>
                <div class="name">Mr. Prakarsh A Sangave</div>
                <div class="subtitle">(Chief Executive Officer)</div>
                <div class="qualification-1">M.E (Civil-Structures)</div>
                <div class="qualification-2">M.Tech (Civil-Geotechnical), M.I.E, F.I.E.</div>
            </div>
        </div>

        <!-- Footer for Page 3 -->
        <div class="footer">
            <div class="footer-divider">X‚Äî‚Äî‚ÄîX‚Äî‚Äî‚ÄîX‚Äî‚Äî‚Äî END OF OBSERVATIONS ‚Äî‚ÄîX‚Äî‚Äî‚ÄîX‚Äî‚Äî‚ÄîX</div>
            <div class="footer-content">
                <div class="footer-left">
                    VA/TR/I-3/24
                </div>
                <div class="footer-center">
                    34A/26 West, New Pachha Peth, Ashok Chowk, Solapur <br>
                    Mob. No.-9552529235, 9145153496, E-mail: vitragassociates3@gmail.com
                </div>
                <div class="footer-right">
                    Page 3 of 3 <br>
                    Issue No. 03
                </div>
            </div>
        </div>
    </div>

    <!-- Download PDF Button -->
    <button class="download-btn" onclick="downloadPDF()">üìÑ Download PDF</button>

    <script>
        // ‚úÖ CONTROL WHICH PAGES TO SHOW BASED ON page_type PARAMETER
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const pageType = urlParams.get('page_type');
            
            console.log('üîç FINAL TEST REPORT - PDF Page Type:', pageType);
            
            // Get all page elements
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const page3 = document.getElementById('page3');
            const page4 = document.getElementById('page4');
            
            // FINAL TEST REPORT: Always show ONLY pages 2, 3, 4 (hide page 1)
            console.log('‚úÖ FINAL TEST REPORT: Showing Pages 2, 3, 4 (Final Test Report)');
            page1.style.display = 'none';
            page2.style.display = 'block';
            page3.style.display = 'block';
            page4.style.display = 'block';
        })();
        
        // Function to populate form data from URL parameters
        function populateFormData() {
            console.log('========================================');
            console.log('üöÄ POPULATE FORM DATA STARTED!');
            console.log('========================================');
            
            const urlParams = new URLSearchParams(window.location.search);
            
            console.log('üìã ALL URL PARAMS:');
            for (let [key, value] of urlParams.entries()) {
                console.log(`   ${key}:`, value);
            }

            // General Information (Observation Report - Page 1)
            document.getElementById('sample-description').textContent = urlParams.get('sample_description') || 'Concrete Cube Specimen';
            document.getElementById('date-of-receipt').textContent = urlParams.get('date_of_receipt') || '';
            document.getElementById('sample-test-code').textContent = urlParams.get('job_code_number') || '';
            document.getElementById('date-of-testing').textContent = urlParams.get('date_of_testing') || '';
            
            // Auto-detect quantity from block_id parameters
            let quantityValue = urlParams.get('quantity_of_blocks');
            if (!quantityValue) {
                let count = 0;
                for (let i = 1; i <= 6; i++) {
                    if (urlParams.get(`block_id_${i}`)) count++;
                }
                quantityValue = count > 0 ? count : '';
            }
            document.getElementById('quantity-of-blocks').textContent = quantityValue;
            
            document.getElementById('date-of-casting').textContent = urlParams.get('date_of_casting') || '';
            
            const gradeValue = urlParams.get('grade_of_blocks') || 'M25';
            document.getElementById('grade-of-blocks').textContent = gradeValue;
            console.log('‚úÖ Grade of Blocks:', gradeValue);
            
            document.getElementById('blocks-condition').textContent = urlParams.get('blocks_condition') || 'Acceptable';
            
            // Calculate age if both dates are provided
            const castingDate = urlParams.get('date_of_casting');
            const testingDate = urlParams.get('date_of_testing');
            let ageValue = urlParams.get('manufacture_of_blocks') || urlParams.get('age_of_cube') || '';
            if (!ageValue && castingDate && testingDate) {
                const casting = new Date(castingDate);
                const testing = new Date(testingDate);
                const diffTime = Math.abs(testing - casting);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                ageValue = diffDays + ' Days';
            }
            document.getElementById('manufacture-of-blocks').textContent = ageValue;
            
            document.getElementById('curing-condition').textContent = urlParams.get('curing_condition') || '';
            document.getElementById('machine-used-for-testing').textContent = urlParams.get('machine_used_for_testing') || 'CTM (2000KN)';
            document.getElementById('test-method').textContent = urlParams.get('test_method') || 'IS 516 (Part1/Sec1):2021';
            document.getElementById('environmental-conditions').textContent = urlParams.get('environmental_conditions') || '';
            
            // Test Results (Observation Report - Page 1)
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`block-id-${i}`).textContent = urlParams.get(`block_id_${i}`) || '';
                // Combine length x breadth x height for size
                const length = urlParams.get(`length_${i}`) || '';
                const breadth = urlParams.get(`breadth_${i}`) || '';
                const height = urlParams.get(`height_${i}`) || '';
                const size = length && breadth && height ? `${length} x ${breadth} x ${height}` : '';
                document.getElementById(`size-${i}`).textContent = size;
                document.getElementById(`area-${i}`).textContent = urlParams.get(`area_${i}`) || '';
                document.getElementById(`weight-${i}`).textContent = urlParams.get(`weight_${i}`) || '';
                document.getElementById(`load-max-${i}`).textContent = urlParams.get(`load_max_${i}`) || '';
                document.getElementById(`density-${i}`).textContent = urlParams.get(`density_${i}`) || '';
                document.getElementById(`compressive-strength-${i}`).textContent = urlParams.get(`compressive_strength_${i}`) || '';
                document.getElementById(`failure-type-${i}`).textContent = urlParams.get(`failure_type_${i}`) || '';
            }
            
            // Calculate and display averages
            let compressiveSum = 0;
            let densitySum = 0;
            let loadSum = 0;
            let count = 0;
            
            for (let i = 1; i <= 6; i++) {
                const compressiveValue = parseFloat(urlParams.get(`compressive_strength_${i}`)) || 0;
                const densityValue = parseFloat(urlParams.get(`density_${i}`)) || 0;
                const loadValue = parseFloat(urlParams.get(`load_max_${i}`)) || 0;
                
                if (compressiveValue > 0) {
                    compressiveSum += compressiveValue;
                    densitySum += densityValue;
                    loadSum += loadValue;
                    count++;
                }
            }
            
            const compressiveAverage = count > 0 ? (compressiveSum / count).toFixed(2) : '0.00';
            const densityAverage = count > 0 ? (densitySum / count).toFixed(2) : '0.00';
            const loadAverage = count > 0 ? (loadSum / count).toFixed(2) : '0.00';
            
            document.getElementById('avg-compressive-strength').textContent = compressiveAverage;
            document.getElementById('avg-density').textContent = densityAverage;
            
            // Update the average strength in the test results table
            const avgStrengthEl = document.getElementById('average-strength');
            if (avgStrengthEl) {
                avgStrengthEl.innerHTML = `<span class="highlight-text">${compressiveAverage}</span>`;
            }
            console.log('Calculated averages - Compressive:', compressiveAverage, 'Density:', densityAverage, 'Load:', loadAverage, 'from', count, 'values');
            
            // Verification (Observation Report - Page 1)
            // Only show user input data, leave empty if not provided
            const testedByName = urlParams.get('tested_by_name');
            const checkedByName = urlParams.get('checked_by_name');
            const verifiedByName = urlParams.get('verified_by_name');
            const testedByDate = urlParams.get('tested_by_date');
            const checkedByDate = urlParams.get('checked_by_date');
            const verifiedByDate = urlParams.get('verified_by_date');
            
            console.log('üë§ Signature Data:', {
                testedBy: testedByName,
                checkedBy: checkedByName,
                verifiedBy: verifiedByName,
                dates: { testedByDate, checkedByDate, verifiedByDate }
            });
            
            // Update tested by (only if user provided data)
            if (testedByName && testedByName.trim() !== '') {
                document.getElementById('tested-by-name').textContent = testedByName;
            } else {
                document.getElementById('tested-by-name').textContent = ''; // Empty if not provided
            }
            if (testedByDate && testedByDate.trim() !== '') {
                document.getElementById('tested-by-date').textContent = testedByDate;
            } else {
                document.getElementById('tested-by-date').textContent = '';
            }
            
            // Update checked by (only if user provided data)
            if (checkedByName && checkedByName.trim() !== '') {
                document.getElementById('checked-by-name').textContent = checkedByName;
            } else {
                document.getElementById('checked-by-name').textContent = ''; // Empty if not provided
            }
            if (checkedByDate && checkedByDate.trim() !== '') {
                document.getElementById('checked-by-date').textContent = checkedByDate;
            } else {
                document.getElementById('checked-by-date').textContent = '';
            }
            
            // Update verified by (only if user provided data)
            if (verifiedByName && verifiedByName.trim() !== '') {
                document.getElementById('verified-by-name').textContent = verifiedByName;
            } else {
                document.getElementById('verified-by-name').textContent = ''; // Empty if not provided
            }
            if (verifiedByDate && verifiedByDate.trim() !== '') {
                document.getElementById('verified-by-date').textContent = verifiedByDate;
            } else {
                document.getElementById('verified-by-date').textContent = '';
            }
            
            // Remarks (Observation Report - Page 1)
            document.getElementById('remarks-content').textContent = urlParams.get('remarks') || '';
            
            // Current date
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-GB');
            
            // Auto-resize text for metadata fields
            autoResizeMetadataText();
            
            // Set up observer for dynamic content changes
            setupContentObserver();
            
            // Populate Test Report Customer Information Table AFTER average is calculated
            populateTestReportData(urlParams);
            
            // Populate Strength Graph (Page 4)
            populateStrengthGraph(urlParams);
            
            // Populate Observations (Page 4)
            populateObservations(urlParams);
        }
        
        // Function to auto-resize metadata text based on content length
        function autoResizeMetadataText() {
            // Get all metadata table cells (excluding header cells)
            const metaTable = document.querySelector('table.meta');
            if (!metaTable) return;
            
            const allCells = metaTable.querySelectorAll('td');
            
            allCells.forEach(cell => {
                const text = cell.textContent.trim();
                const length = text.length;
                
                // Remove existing auto-sizing classes
                cell.classList.remove('long-text', 'very-long-text', 'extra-long-text', 'auto-fit', 'auto-resize');
                
                // Apply appropriate class based on text length
                if (length > 100) {
                    cell.classList.add('auto-resize', 'extra-long-text');
                } else if (length > 70) {
                    cell.classList.add('auto-resize', 'very-long-text');
                } else if (length > 50) {
                    cell.classList.add('auto-resize', 'long-text');
                } else {
                    // Keep default size for short text but still apply auto-resize
                    cell.classList.add('auto-resize');
                }
            });
            
            // Handle Remarks section auto-sizing
            const remarksContent = document.getElementById('remarks-content');
            if (remarksContent) {
                const remarksText = remarksContent.textContent.trim();
                const remarksLength = remarksText.length;
                
                // Remove existing auto-sizing classes
                remarksContent.classList.remove('long-text', 'very-long-text', 'extra-long-text', 'auto-resize');
                
                // Apply appropriate class based on text length
                if (remarksLength > 200) {
                    remarksContent.classList.add('auto-resize', 'extra-long-text');
                } else if (remarksLength > 150) {
                    remarksContent.classList.add('auto-resize', 'very-long-text');
                } else if (remarksLength > 100) {
                    remarksContent.classList.add('auto-resize', 'long-text');
                } else {
                    // Keep default size for short text but still apply auto-resize
                    remarksContent.classList.add('auto-resize');
                }
            }
        }
        
        // Function to set up observer for dynamic content changes
        function setupContentObserver() {
            const metaTable = document.querySelector('table.meta');
            if (!metaTable) return;
            
            // Create a MutationObserver to watch for content changes
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList' || mutation.type === 'characterData') {
                        // Re-run auto-sizing when content changes
                        setTimeout(autoResizeMetadataText, 100);
                    }
                });
            });
            
            // Observe all cells in the metadata table
            const allCells = metaTable.querySelectorAll('td');
            allCells.forEach(cell => {
                observer.observe(cell, {
                    childList: true,
                    characterData: true,
                    subtree: true
                });
            });
            
            // Also observe the remarks content
            const remarksContent = document.getElementById('remarks-content');
            if (remarksContent) {
                observer.observe(remarksContent, {
                    childList: true,
                    characterData: true,
                    subtree: true
                });
            }
        }
        
        // Function to populate Test Report data (PAGE 2)
        function populateTestReportData(urlParams) {
            console.log('====================================');
            console.log('üìÑ POPULATING PAGE 2 DATA NOW!');
            console.log('====================================');
            
            // Customer Information Table - Page 2
            const customerName = urlParams.get('customer_name') || '';
            const siteName = urlParams.get('site_name') || '';
            const siteAddress = urlParams.get('site_address') || '';
            
            console.log('üìç Customer Name:', customerName);
            console.log('üìç Site Name:', siteName);
            console.log('üìç Site Address:', siteAddress);
            
            // Update customer-site-name element
            const customerSiteEl = document.getElementById('customer-site-name');
            if (customerSiteEl) {
                customerSiteEl.textContent = `${customerName}, ${siteName} ${siteAddress}`;
                console.log('‚úÖ Updated customer-site-name:', customerSiteEl.textContent);
            }
            
            // Update date of report
            const dateOfReport = urlParams.get('date_of_report') || new Date().toLocaleDateString('en-GB');
            const dateOfReportEl = document.getElementById('date-of-report');
            if (dateOfReportEl) {
                dateOfReportEl.textContent = dateOfReport;
            }
            
            // Update ULR Number
            const ulrNumber = urlParams.get('ulr_number') || '';
            const ulrEl = document.getElementById('ulr-number');
            if (ulrEl) {
                ulrEl.textContent = ulrNumber;
            }
            
            // Update Reference Number
            const referenceNumber = urlParams.get('reference_number') || '';
            const refEl = document.getElementById('reference-number');
            if (refEl) {
                refEl.textContent = referenceNumber;
            }
            
            // Update Job Code Number
            const jobCodeNumber = urlParams.get('job_code_number') || '';
            const jobEl = document.getElementById('job-code-number');
            if (jobEl) {
                jobEl.textContent = jobCodeNumber;
            }
            
            // Update Date of Receipt
            const dateOfReceipt = urlParams.get('date_of_receipt') || '';
            const receiptEl = document.getElementById('date-of-receipt');
            if (receiptEl) {
                receiptEl.textContent = dateOfReceipt;
            }
            
            // Update Date of Casting
            const dateOfCasting = urlParams.get('date_of_casting') || '';
            const castingEl = document.getElementById('date-of-casting');
            if (castingEl) {
                castingEl.innerHTML = `<span class="highlight-text">${dateOfCasting}</span>`;
            }
            
            // Update Date of Testing
            const dateOfTesting = urlParams.get('date_of_testing') || '';
            const testingEl = document.getElementById('date-of-testing');
            if (testingEl) {
                testingEl.textContent = dateOfTesting;
            }
            
            // Update Location/Structure Type
            const locationStructure = urlParams.get('location_structure') || '';
            const locationEl = document.getElementById('location-structure');
            if (locationEl) {
                locationEl.textContent = locationStructure;
            }
            
            // Update Age of Specimen
            const ageOfSpecimen = urlParams.get('age_of_specimen') || '';
            const ageEl = document.getElementById('age-of-specimen');
            if (ageEl) {
                ageEl.innerHTML = `<div class="age-cell-content"><span class="highlight-text">${ageOfSpecimen}</span><div class="age-divider"></div><span>Days</span></div>`;
            }
            
            // Update Grade of Specimen
            const gradeOfSpecimen = urlParams.get('grade_of_specimen') || '';
            const gradeEl = document.getElementById('grade-of-specimen');
            if (gradeEl) {
                gradeEl.innerHTML = `<span class="highlight-text">${gradeOfSpecimen}</span>`;
            }
            
            // Update Type of Specimen
            const typeOfSpecimen = urlParams.get('type_of_specimen') || 'Concrete Cube';
            const typeEl = document.getElementById('type-of-specimen');
            if (typeEl) {
                typeEl.textContent = typeOfSpecimen;
            }
            
            // Update Condition of Specimen
            const conditionOfSpecimen = urlParams.get('condition_of_specimen') || 'Acceptable';
            const conditionEl = document.getElementById('condition-of-specimen');
            if (conditionEl) {
                conditionEl.textContent = conditionOfSpecimen;
            }
            
            // Update Machine Used
            const machineUsed = urlParams.get('machine_used') || '';
                const machineEl = document.getElementById('machine-used');
                if (machineEl) {
                    machineEl.textContent = 'Fully automatic Digital Compression Testing Machine';
                    machineEl.style.fontWeight = 'normal';
                    console.log('‚úÖ Machine FORCED to: Fully automatic Digital Compression Testing Machine');
                } else {
                    console.error('‚ùå machine-used element NOT FOUND!');
                }
            
            // Update Capacity Range
            const capacityRange = urlParams.get('capacity_range') || '2000KN';
            const capacityEl = document.getElementById('capacity-range');
            if (capacityEl) {
                capacityEl.textContent = capacityRange;
            }
            
            // Update Calibration Due Date
            const calibrationDueDate = urlParams.get('calibration_due_date') || '';
            const calEl = document.getElementById('calibration-due-date');
            if (calEl) {
                calEl.textContent = calibrationDueDate;
            }
            
            // ===== POPULATE TEST SAMPLE TABLES (Page 2) =====
            // Update "DESCRIPTION OF TEST SAMPLE" table
            for (let i = 1; i <= 3; i++) {
                const blockId = urlParams.get(`block_id_${i}`) || '------';
                const length = urlParams.get(`length_${i}`) || '';
                const breadth = urlParams.get(`breadth_${i}`) || '';
                const height = urlParams.get(`height_${i}`) || '';
                const area = urlParams.get(`area_${i}`) || '';
                const weight = urlParams.get(`weight_${i}`) || '';
                const load = urlParams.get(`load_max_${i}`) || '';
                
                // Update elements
                const idEl = document.getElementById(`sample-${i}-id`);
                if (idEl) idEl.textContent = blockId;
                
                const lengthEl = document.getElementById(`sample-${i}-length`);
                if (lengthEl) lengthEl.textContent = length;
                
                const breadthEl = document.getElementById(`sample-${i}-breadth`);
                if (breadthEl) breadthEl.textContent = breadth;
                
                const heightEl = document.getElementById(`sample-${i}-height`);
                if (heightEl) heightEl.textContent = height;
                
                const areaEl = document.getElementById(`sample-${i}-area`);
                if (areaEl) areaEl.textContent = area;
                
                const weightEl = document.getElementById(`sample-${i}-weight`);
                if (weightEl) weightEl.textContent = weight;
                
                const loadEl = document.getElementById(`sample-${i}-load`);
                if (loadEl) loadEl.textContent = load;
            }
            
            // Update "Test Result for Density and Compressive Strength" table
            let strengthSum = 0;
            let count = 0;
            
            for (let i = 1; i <= 3; i++) {
                const resultId = urlParams.get(`block_id_${i}`) || `C${i}`;
                const density = urlParams.get(`density_${i}`) || '';
                const strength = urlParams.get(`compressive_strength_${i}`) || '';
                
                const idEl = document.getElementById(`result-${i}-id`);
                if (idEl) idEl.textContent = resultId;
                
                const densityEl = document.getElementById(`result-${i}-density`);
                if (densityEl) densityEl.textContent = density;
                
                const strengthEl = document.getElementById(`result-${i}-strength`);
                if (strengthEl) strengthEl.textContent = strength;
                
                // Calculate average
                const strengthVal = parseFloat(strength);
                if (!isNaN(strengthVal) && strengthVal > 0) {
                    strengthSum += strengthVal;
                    count++;
                }
            }
            
            // Update average strength
            const avgStrength = count > 0 ? (strengthSum / count).toFixed(3) : '0.000';
            const avgEl = document.getElementById('average-strength');
            if (avgEl) {
                avgEl.innerHTML = `<span class="highlight-text">${avgStrength}</span>`;
            }
            
            console.log('‚úÖ Page 2 ALL data populated!');
        }

        // Function to populate Strength Graph (Page 4)
        function populateStrengthGraph(urlParams) {
            const required_7 = parseFloat(urlParams.get('required_7')) || 16.5;
            const actual_7 = parseFloat(urlParams.get('actual_7')) || 18.5;
            const required_14 = parseFloat(urlParams.get('required_14')) || 22.5;
            const actual_14 = parseFloat(urlParams.get('actual_14')) || 24.1;
            const required_28 = parseFloat(urlParams.get('required_28')) || 30.0;
            const actual_28 = parseFloat(urlParams.get('actual_28')) || 31.5;
            
            console.log('üìä Strength Graph Data:', {required_7, actual_7, required_14, actual_14, required_28, actual_28});
            
            // Find the bars container
            const barsContainer = document.getElementById('bars-container');
            
            if (!barsContainer) {
                console.warn('Bars container not found!');
                return;
            }
            
            // Maximum strength for scaling (static Y-axis goes 0-45)
            const maxStrength = 45;
            
            // Maximum height for bars in pixels
            const maxHeight = 200;
            
            // Calculate bar heights (proportional to strength values)
            const calculateHeight = (value) => {
                return (value / maxStrength) * maxHeight;
            };
            
            // Create bars HTML with proper alignment
            barsContainer.innerHTML = `
                <!-- 7 Days -->
                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                        <div style="width: 50px; height: ${calculateHeight(required_7)}px; background-color: #4682B4;"></div>
                        <div style="width: 50px; height: ${calculateHeight(actual_7)}px; background-color: #FFA500;"></div>
                    </div>
                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">7 days strength</div>
                    <div style="margin-top: 20px; font-size: 7pt; color: #000; display: flex; gap: 15px; line-height: 1.3;">
                        <span style="text-align: center; min-width: 35px;">${required_7.toFixed(1)}</span>
                        <span style="text-align: center; min-width: 35px;">${actual_7.toFixed(2)}</span>
                    </div>
                </div>
                
                <!-- 14 Days -->
                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                        <div style="width: 50px; height: ${calculateHeight(required_14)}px; background-color: #4682B4;"></div>
                        <div style="width: 50px; height: ${calculateHeight(actual_14)}px; background-color: #FFA500;"></div>
                    </div>
                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">14 days strength</div>
                    <div style="margin-top: 20px; font-size: 7pt; color: #000; display: flex; gap: 15px; line-height: 1.3;">
                        <span style="text-align: center; min-width: 35px;">${required_14.toFixed(1)}</span>
                        <span style="text-align: center; min-width: 35px;">${actual_14.toFixed(2)}</span>
                    </div>
                </div>
                
                <!-- 28 Days -->
                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                    <div style="display: flex; gap: 4px; align-items: flex-end;">
                        <div style="width: 50px; height: ${calculateHeight(required_28)}px; background-color: #4682B4;"></div>
                        <div style="width: 50px; height: ${calculateHeight(actual_28)}px; background-color: #FFA500;"></div>
                    </div>
                    <div style="margin-top: 6px; font-size: 7pt; color: #000;">28 days strength</div>
                    <div style="margin-top: 20px; font-size: 7pt; color: #000; display: flex; gap: 15px; line-height: 1.3;">
                        <span style="text-align: center; min-width: 35px;">${required_28.toFixed(1)}</span>
                        <span style="text-align: center; min-width: 35px;">${actual_28.toFixed(2)}</span>
                    </div>
                </div>
            `;
            
            console.log('‚úÖ Strength graph populated with dynamic scale!');
        }
        
        // Function to populate Observations (Page 4) - The 6 observation points
        function populateObservations(urlParams) {
            console.log('üìù Populating observations...');
            
            // Get observation values from URL params
            const obs1 = urlParams.get('obs_strength_duration') || '--';
            const obs2 = urlParams.get('obs_test_results') || 'Satisfactory';
            const obs3 = urlParams.get('obs_weight') || 'Satisfactory';
            const obs4 = urlParams.get('obs_failure_pattern') || 'Satisfactory';
            const obs5 = urlParams.get('obs_bonding') || 'Satisfactory';
            const obs6 = urlParams.get('obs_strength_criteria') || '--';
            
            // Update the observation cells
            const obs1El = document.getElementById('obs-strength-duration');
            const obs2El = document.getElementById('obs-test-results');
            const obs3El = document.getElementById('obs-weight');
            const obs4El = document.getElementById('obs-failure-pattern');
            const obs5El = document.getElementById('obs-bonding');
            const obs6El = document.getElementById('obs-strength-criteria');
            
            if (obs1El) obs1El.textContent = obs1;
            if (obs2El) obs2El.textContent = obs2;
            if (obs3El) obs3El.textContent = obs3;
            if (obs4El) obs4El.textContent = obs4;
            if (obs5El) obs5El.textContent = obs5;
            if (obs6El) obs6El.textContent = obs6;
            
            console.log('‚úÖ Observations populated:', {obs1, obs2, obs3, obs4, obs5, obs6});
        }

        // Download PDF function
        function downloadPDF() {
            console.log('Download PDF clicked');

            // Get data for filename
            const urlParams = new URLSearchParams(window.location.search);
            const customerName = urlParams.get('customer_site_name') || 'Customer';
            const dateOfTesting = urlParams.get('date_of_testing') || new Date().toISOString().split('T')[0];

            // Create default filename
            const defaultFilename = `Cube_Testing_Report_${customerName.replace(/\s+/g, '_')}_${dateOfTesting}.pdf`;

            // Set document title
            document.title = defaultFilename;

            // Show instructions
            alert('Print dialog will open. Please select "Save as PDF" and use the suggested filename: ' + defaultFilename);

            // Open print dialog
            window.print();
        }

        // Function to auto-resize text for overflowing content
        function autoResizeText() {
            const addressCell = document.getElementById('customer-site-name');
            if (addressCell) {
                const maxWidth = addressCell.offsetWidth;
                const text = addressCell.textContent;

                // Start with base font size
                let fontSize = 14;
                addressCell.style.fontSize = fontSize + 'px';

                // Check if text overflows
                while (addressCell.scrollWidth > maxWidth && fontSize > 8) {
                    fontSize -= 0.5;
                    addressCell.style.fontSize = fontSize + 'px';
                }

                // If still overflowing, enable word wrapping
                if (addressCell.scrollWidth > maxWidth) {
                    addressCell.style.wordBreak = 'break-all';
                    addressCell.style.whiteSpace = 'normal';
                }
            }
        }

        // Function to render strength graph
        function renderStrengthGraph() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Show debug info on page
            const debugDiv = document.getElementById('debug-info');
            if (debugDiv) {
                debugDiv.textContent = `DEBUG: req7=${urlParams.get('required_7')} act7=${urlParams.get('actual_7')} req14=${urlParams.get('required_14')} act14=${urlParams.get('actual_14')} req28=${urlParams.get('required_28')} act28=${urlParams.get('actual_28')}`;
            }
            
            console.log('URL Parameters:', window.location.search);
            console.log('required_7 param:', urlParams.get('required_7'));
            console.log('actual_7 param:', urlParams.get('actual_7'));
            
            // Get strength data from URL parameters
            const required7 = urlParams.has('required_7') ? parseFloat(urlParams.get('required_7')) : 0;
            const actual7 = urlParams.has('actual_7') ? parseFloat(urlParams.get('actual_7')) : 0;
            const required14 = urlParams.has('required_14') ? parseFloat(urlParams.get('required_14')) : 0;
            const actual14 = urlParams.has('actual_14') ? parseFloat(urlParams.get('actual_14')) : 0;
            const required28 = urlParams.has('required_28') ? parseFloat(urlParams.get('required_28')) : 0;
            const actual28 = urlParams.has('actual_28') ? parseFloat(urlParams.get('actual_28')) : 0;
            
            console.log('Parsed values - 7 days:', { required: required7, actual: actual7 });
            console.log('Parsed values - 14 days:', { required: required14, actual: actual14 });
            console.log('Parsed values - 28 days:', { required: required28, actual: actual28 });
            
            const chartData = [
                { name: '7 days strength', required: required7, actual: actual7 },
                { name: '14 days strength', required: required14, actual: actual14 },
                { name: '28 days strength', required: required28, actual: actual28 }
            ];
            
            const barsContainer = document.getElementById('bars-container');
            if (!barsContainer) {
                console.error('Bars container not found!');
                return;
            }
            
            console.log('Rendering strength graph with data:', chartData);
            console.log('Bars container found, clearing existing content...');
            
            // Clear existing content - FORCE CLEAR
            barsContainer.innerHTML = '';
            console.log('Container cleared. Children count:', barsContainer.children.length);
            
            // Generate bars for each data point
            chartData.forEach((item, index) => {
                console.log(`Creating bars for ${item.name}: Required=${item.required}, Actual=${item.actual}`);
                const requiredHeight = Math.max((item.required / 45) * 200, 2);
                const actualHeight = Math.max((item.actual / 45) * 200, 2);
                console.log(`Bar heights: Required=${requiredHeight}px, Actual=${actualHeight}px`);
                
                // Create bar group container
                const barGroupContainer = document.createElement('div');
                barGroupContainer.style.cssText = 'display: flex; flex-direction: column; align-items: center; flex: 1; position: relative;';
                
                // Create bars container
                const barsDiv = document.createElement('div');
                barsDiv.style.cssText = 'display: flex; gap: 4px; align-items: flex-end; justify-content: center;';
                
                // Required bar
                const requiredBar = document.createElement('div');
                requiredBar.style.cssText = `width: 50px; height: ${requiredHeight}px; background-color: #4682B4;`;
                barsDiv.appendChild(requiredBar);
                
                // Actual bar
                const actualBar = document.createElement('div');
                actualBar.style.cssText = `width: 50px; height: ${actualHeight}px; background-color: #FFA500;`;
                barsDiv.appendChild(actualBar);
                
                barGroupContainer.appendChild(barsDiv);
                
                // X-axis label
                const xLabel = document.createElement('div');
                xLabel.style.cssText = 'margin-top: 6px; font-size: 7pt; text-align: center; color: #000;';
                xLabel.textContent = item.name;
                barGroupContainer.appendChild(xLabel);
                
                // Data values - vertical layout
                const dataLabels = document.createElement('div');
                dataLabels.style.cssText = 'margin-top: 3px; font-size: 7pt; text-align: center; color: #000; display: flex; flex-direction: column; line-height: 1.3;';
                
                const requiredLabel = document.createElement('span');
                requiredLabel.textContent = item.required.toFixed(1);
                dataLabels.appendChild(requiredLabel);
                
                const actualLabel = document.createElement('span');
                actualLabel.textContent = item.actual.toFixed(2);
                dataLabels.appendChild(actualLabel);
                
                barGroupContainer.appendChild(dataLabels);
                
                barsContainer.appendChild(barGroupContainer);
            });
            
            console.log('Graph rendering complete. Total bars created:', barsContainer.children.length);
        }

        // Populate form data when page loads
        window.onload = function () {
            console.log('==========================================================');
            console.log('‚úÖ PDF PAGE LOADED - STARTING DATA POPULATION');
            console.log('==========================================================');
            populateFormData();
            console.log('‚úÖ populateFormData() completed!');

            // Auto-resize text after a short delay to ensure content is loaded
            setTimeout(autoResizeText, 100);
        };
    </script>
</body>

</html>