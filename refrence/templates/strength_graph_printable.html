{% extends "base.html" %}

{% block title %}{{ page_title }}{% endblock %}

{% block styles %}
{{ super() }}
<style>
    body {
        background-color: white !important;
        color: black !important;
    }
    
    @media print {
        body {
            padding: 0;
            margin: 0;
            background-color: white !important;
            color: black !important;
        }
        
        .container {
            width: 100%;
            max-width: 100%;
            padding: 0;
            margin: 0;
        }

        .no-print {
            display: none !important;
        }
        
        .company-name {
            color: #FFD700 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .lab-name {
            color: #FFA500 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .table-header {
            background-color: #f0f0f0 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
    
    .print-gold {
        color: #D4AF37;
    }
    
    .print-orange {
        color: #FF8C00;
    }

    .report-container {
        padding: 20px;
        background: #fff;
        border-radius: 5px;
        color: black;
    }

    .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .left-logo {
        width: 120px;
        height: auto;
    }
    
    .right-logo {
        width: 100px;
        height: auto;
    }
    
    .company-info {
        text-align: center;
        flex-grow: 1;
    }

    .company-name {
        font-size: 32px;
        font-weight: bold;
        color: #FFD700;
    }

    .lab-name {
        font-size: 22px;
        color: #FFA500;
    }

    .report-title {
        font-size: 20px;
        margin: 20px 0;
        text-align: center;
        font-weight: bold;
    }

    .strength-table {
        width: 100%;
        margin: 30px 0;
        border-collapse: collapse;
    }

    .strength-table th, .strength-table td {
        border: 1px solid #000;
        padding: 8px;
        color: black;
    }

    .strength-table th {
        background-color: #f0f0f0;
        text-align: center;
    }

    .strength-table td {
        text-align: center;
    }

    .observations-table {
        width: 100%;
        margin: 30px 0;
        border-collapse: collapse;
    }

    .observations-table th, .observations-table td {
        border: 1px solid #000;
        padding: 8px;
        color: black;
    }

    .observations-table th {
        background-color: #f0f0f0;
        text-align: center;
    }

    .graph-section {
        margin-top: 30px;
        text-align: center;
    }

    .section-title {
        font-size: 18px;
        font-weight: bold;
        margin: 20px 0 10px 0;
        text-align: center;
    }

    .graph-title {
        font-weight: bold;
        margin-bottom: 10px;
    }

    .footer {
        margin-top: 30px;
        text-align: center;
        font-size: 12px;
        color: #555;
    }

    .print-button {
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 20px 0;
    }

    .print-button:hover {
        background: #0069d9;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="row no-print mb-3">
        <div class="col-12">
            <a href="{{ url_for('view_strength_graph', test_request_id=test_request.id, test_id=concrete_test.id) }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Strength Graph
            </a>
            <button onclick="window.print()" class="btn btn-primary">
                <i class="fas fa-print"></i> Print as PDF
            </button>
        </div>
    </div>

    <div class="report-container">
        <div class="header-container">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Vitrag Labs Logo" class="left-logo">
            <div class="company-info">
                <div class="company-name print-gold">VITRAG ASSOCIATES LLP</div>
                <div class="lab-name print-orange">Construction Material Testing Laboratory</div>
            </div>
            <img src="{{ url_for('static', filename='images/nabl_logo.png') }}" alt="NABL Logo" class="right-logo">
        </div>

        <div class="report-title">Strength Graph Report</div>

        <div class="section-title">Observations</div>
        <table class="observations-table">
            <thead>
                <tr>
                    <th width="5%">No.</th>
                    <th width="75%">Criteria</th>
                    <th width="20%">Observation</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Compressive Strength acquired after specified duration</td>
                    <td>Satisfactory</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Individual test results within +/-15% of average strength</td>
                    <td>Satisfactory</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Weight of cube</td>
                    <td>Satisfactory</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Type of failure Pattern as per IS 516(Part-1/Sec-1): - 2021 Fig.1</td>
                    <td>Satisfactory</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Bonding between Aggregates and cement paste.</td>
                    <td>Satisfactory</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>Compressive Strength as per acceptance criteria as Cl.16.1 of IS 456:2000</td>
                    <td>Satisfactory</td>
                </tr>
            </tbody>
        </table>

        <div class="section-title">Strength Data</div>
        <table class="strength-table">
            <thead>
                <tr>
                    <th width="33%">Curing days</th>
                    <th width="33%">Required strength</th>
                    <th width="33%">Actual Cube strength</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>7 days strength</td>
                    <td>{{ strength_data.get('required_7', '16.5') }}</td>
                    <td>{{ strength_data.get('actual_7', '14.00') }}</td>
                </tr>
                <tr>
                    <td>14 days strength</td>
                    <td>{{ strength_data.get('required_14', '22.5') }}</td>
                    <td>{{ strength_data.get('actual_14', '') }}</td>
                </tr>
                <tr>
                    <td>28 days strength</td>
                    <td>{{ strength_data.get('required_28', '29') }}</td>
                    <td>{{ strength_data.get('actual_28', '') }}</td>
                </tr>
            </tbody>
        </table>

        <div class="section-title">Fig. 2 - Graphical Representation of Comparison of Compressive Strengths</div>
        <div class="graph-section">
            <img src="data:image/png;base64,{{ graph_data }}" alt="Strength Graph" style="max-width: 100%;">
        </div>

        <div class="footer">
            Generated on: {{ now().strftime('%d-%m-%Y') }} | Page 1
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    // No auto-print popup as requested
</script>
{% endblock %}